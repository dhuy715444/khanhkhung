
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Oracle's Veil - AI Tarot Reader</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@300;400&display=swap');
        
        :root {
            --font-main: 'Cinzel', serif;
            --font-body: 'Lato', sans-serif;
            --color-bg-start: #0f0c29;
            --color-bg-mid: #302b63;
            --color-bg-end: #24243e;
            --color-text: #EAEAEA;
            --color-primary: #D4AF37;
            --color-secondary: #E67E22;
            --color-surface: rgba(0, 0, 0, 0.25);
            --color-surface-heavy: rgba(0, 0, 0, 0.4);
            --color-surface-light: rgba(255, 255, 255, 0.05);
            --glow-primary: 0 0 15px rgba(212, 175, 55, 0.4);
            --glow-secondary: 0 0 15px rgba(230, 126, 34, 0.4);
        }

        body { 
            background: linear-gradient(-45deg, var(--color-bg-start), var(--color-bg-mid), var(--color-bg-end));
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: var(--color-text); font-family: var(--font-body); margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh;
        }

        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        
        .container { width: 100%; max-width: 1200px; margin: auto; }
        
        #deck-selection-screen, #reading-chamber-screen { animation: fadeInScreen 0.8s ease-in-out; }
        #reading-chamber-screen { display: none; }

        #deck-selection-screen h1 { font-family: var(--font-main); font-weight: 700; font-size: clamp(2.5rem, 6vw, 4rem); letter-spacing: 4px; text-shadow: 0 0 10px rgba(255,255,255,0.1); }
        #deck-selection-screen p { font-size: 1.1rem; opacity: 0.8; }
        .deck-choices { display: flex; justify-content: center; gap: 40px; flex-wrap: wrap; margin-top: 50px; }
        
        .deck-card {
            background-color: var(--color-surface); border: 2px solid var(--color-surface-heavy);
            width: 280px; min-height: 420px; display: flex; flex-direction: column; 
            justify-content: space-around; align-items: center; 
            padding: 20px; border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: transform 0.4s ease, border-color 0.4s ease, box-shadow 0.4s ease;
        }
        #gold-foil-deck { border-color: var(--color-primary); }
        #dark-tarot-deck { border-color: var(--color-secondary); }
        .deck-card:hover { transform: translateY(-5px); }
        #gold-foil-deck:hover { box-shadow: var(--glow-primary); border-color: var(--color-primary); }
        #dark-tarot-deck:hover { box-shadow: var(--glow-secondary); border-color: var(--color-secondary); }

        .deck-info h2 { font-family: var(--font-main); font-size: 1.8rem; margin: 10px 0; }
        #gold-foil-deck h2 { color: var(--color-primary); }
        #dark-tarot-deck h2 { color: var(--color-secondary); }
        .deck-info .description { font-size: 0.95rem; text-align: center; font-weight: 300; line-height: 1.6; opacity: 0.9; margin-bottom: 20px; }

        .mode-selection-buttons { display: flex; flex-direction: column; gap: 15px; width: 100%; }
        .mode-btn {
            background: var(--color-surface-light); border: 1px solid #555;
            color: var(--color-text); padding: 12px; border-radius: 5px;
            font-family: var(--font-body); font-size: 1rem; cursor: pointer;
            transition: all 0.3s ease; width: 100%;
        }
        .mode-btn:hover { background: var(--color-surface-heavy); transform: scale(1.03); }
        #gold-foil-deck .mode-btn:hover { border-color: var(--color-primary); }
        #dark-tarot-deck .mode-btn:hover { border-color: var(--color-secondary); }
        
        #reading-chamber-grid { display: flex; flex-direction: column; gap: 30px; }
        #left-panel-content { transition: opacity 0.5s ease-out; }
        #manual-selection-container { display: none; text-align: center; }
        #manual-selection-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(70px, 1fr)); gap: 15px; perspective: 1000px; margin: 20px 0;}
        #manual-selection-prompt { font-size: 1.1rem; font-family: var(--font-main); letter-spacing: 1px; }
        .mini-card {
            width: 70px; height: 110px; background: var(--color-surface-heavy);
            border: 1px solid #444; border-radius: 5px; cursor: pointer;
            display: flex; justify-content: center; align-items: center;
            font-family: var(--font-main); font-size: 1.5rem; color: #888;
            transition: all 0.3s ease; position: relative;
        }
        .mini-card:hover { transform: translateY(-5px) scale(1.05); border-color: var(--color-text); }
        .mini-card.selected { transform: translateY(-10px) scale(1.1); border-color: var(--color-primary); box-shadow: var(--glow-primary); color: var(--color-primary);}
        .mini-card.selected.dark-tarot { border-color: var(--color-secondary); box-shadow: var(--glow-secondary); color: var(--color-secondary);}
        #confirm-selection-btn {
             background-color: var(--color-primary); color: var(--color-bg-start);
             border: none; font-family: var(--font-main); font-size: 1.1rem;
             padding: 10px 30px; border-radius: 25px; cursor: pointer; margin-top: 10px;
             transition: all 0.3s ease;
        }
        #confirm-selection-btn.dark-tarot { background-color: var(--color-secondary); }
        #confirm-selection-btn:disabled { background-color: #555; color: #999; cursor: not-allowed; }

        #card-display { display: flex; justify-content: center; gap: 25px; margin-bottom: 20px; min-height: 250px; flex-wrap: wrap; perspective: 1200px; }
        .tarot-card-container { width: 150px; height: 230px; opacity: 0; animation: fadeInCard 0.6s forwards; cursor: default; }

        .tarot-card { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 0.9s cubic-bezier(0.22, 1, 0.36, 1); box-shadow: 0 5px 20px rgba(0,0,0,0.5); border-radius: 10px;}
        .tarot-card-container.flipped .tarot-card { transform: rotateY(180deg); }
        
        .card-face { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: space-between; text-align: center; padding: 10px; border-radius: 10px; box-sizing: border-box; }
        .card-face-back { background-color: var(--color-surface); background-position: center; background-repeat: no-repeat; }
        .card-face-back.goldFoil { 
            border: 2px solid var(--color-primary); 
            background-image: radial-gradient(circle, var(--color-primary) 1px, transparent 1.5px), url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cpath d='M50 0L61.2 38.8L100 50L61.2 61.2L50 100L38.8 61.2L0 50L38.8 38.8z' fill='%23d4af37'/%3E%3C/svg%3E");
            background-size: 20px 20px, 60px 60px; background-position: center; opacity: 0.6;
        }
        .card-face-back.darkTarot { 
            border: 2px solid var(--color-secondary); 
            background-image: radial-gradient(circle, var(--color-secondary) 1px, transparent 1.5px), url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23e67e22' stroke='%23e67e22' stroke-width='0.5'%3E%3Cpath d='M12 2l-2 4h4zM10 22l2-4h-4zM2 12l4 2v-4zM22 12l-4-2v4zM4.929 4.929l2.828 2.828 1.414-1.414-2.828-2.828zM14.828 14.828l2.828 2.828 1.414-1.414-2.828-2.828zM4.929 19.071l2.828-2.828 1.414 1.414-2.828 2.828zM14.828 9.172l2.828-2.828 1.414 1.414-2.828 2.828z'/%3E%3C/svg%3E");
            background-size: 20px 20px, 50px 50px; background-position: center; opacity: 0.6;
        }
        .card-face-front { background-color: #2c2c2c; transform: rotateY(180deg); }
        .card-face-front.goldFoil { border: 1px solid var(--color-primary); box-shadow: inset 0 0 10px rgba(212,175,55,0.2); }
        .card-face-front.darkTarot { border: 1px solid var(--color-secondary); box-shadow: inset 0 0 10px rgba(230,126,34,0.2); }
        .tarot-card-container.reversed .card-visual { transform: rotate(180deg); }
        
        .card-name { font-family: var(--font-main); font-weight: 700; font-size: 0.9rem; letter-spacing: 0.5px;}
        .card-visual svg { width: 90%; height: 90%; }
        .card-position { font-size: 0.75rem; font-style: italic; color: #aaa; }
        
        @keyframes fadeInScreen { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInCard { from { opacity: 0; transform: translateY(40px) rotateX(-20deg); } to { opacity: 1; transform: translateY(0) rotateX(0deg); } }
        
        #interpretation-area { background-color: var(--color-surface); padding: 30px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); border-top: 2px solid #333; min-height: 150px;}
        #interpretation-area h2, #interpretation-area h3, #interpretation-area h4 { font-family: var(--font-main); letter-spacing: 1px; }
        #interpretation-area h2 { font-size: 1.5em; text-align: center; color: var(--color-primary); margin-bottom: 1.5em; }
        #interpretation-area.dark-tarot h2 { color: var(--color-secondary); }
        #interpretation-area h3 { font-size: 1.25em; margin-top: 1.5em; margin-bottom: 0.75em; border-left: 3px solid #666; padding-left: 10px; }
        #interpretation-area h4 { font-size: 1.1em; font-style: italic; color: #ccc; margin-top: 1.2em; margin-bottom: 0.5em;}
        #interpretation-area p, #interpretation-area li { line-height: 1.7; opacity: 0.9; }
        #interpretation-area ul { list-style: none; padding-left: 1em; }
        #interpretation-area li { position: relative; padding-left: 1.5em; margin-bottom: 0.5em;}
        #interpretation-area li::before {
            content: '✧'; position: absolute; left: 0; top: 0; color: var(--color-primary);
        }
        #interpretation-area.dark-tarot li::before { color: var(--color-secondary); content: '•';}
        #interpretation-area strong { color: var(--color-text); font-weight: bold;}


        #spread-name { text-align: center; font-family: var(--font-main); letter-spacing: 1px; font-size: 1.5rem; margin-bottom: 30px; opacity: 0; transition: opacity 0.5s ease; }
        #spread-name.visible { opacity: 1; }

        #chat-interface { background-color: var(--color-surface-heavy); border-radius: 8px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        #chat-log { height: 250px; overflow-y: auto; background: rgba(0,0,0,0.25); padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #333; }
        #chat-log::-webkit-scrollbar { width: 8px; }
        #chat-log::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); border-radius: 4px;}
        #chat-log::-webkit-scrollbar-thumb { background: #555; border-radius: 4px; }
        #chat-log::-webkit-scrollbar-thumb:hover { background: #777; }
        .chat-message { max-width: 85%; padding: 12px 18px; border-radius: 18px; margin-bottom: 10px; line-height: 1.5; font-size: 0.95rem; animation: fadeInMessage 0.3s ease-out; }
        @keyframes fadeInMessage { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); }}
        .user-message { background-color: var(--color-bg-mid); color: var(--color-text); margin-left: auto; border-bottom-right-radius: 5px; }
        .oracle-message { background-color: rgba(0,0,0,0.3); border: 1px solid #444; margin-right: auto; border-bottom-left-radius: 5px; }
        #chat-form { display: flex; }
        #user-input { flex-grow: 1; background-color: var(--color-surface); border: 1px solid #444; color: var(--color-text); padding: 14px 18px; border-radius: 25px 0 0 25px; font-size: 1rem; transition: border-color 0.3s ease; }
        #user-input:focus { outline: none; border-color: var(--color-primary); box-shadow: inset 0 0 5px rgba(0,0,0,0.5);}
        #user-input::placeholder { color: #888; }
        #submit-button { background-color: var(--color-primary); border: none; color: var(--color-bg-start); padding: 0 25px; font-size: 1rem; font-family: var(--font-main); font-weight: 700; cursor: pointer; border-radius: 0 25px 25px 0; transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s; }
        #submit-button.dark-tarot { background-color: var(--color-secondary); }
        #submit-button:hover { transform: scale(1.02); box-shadow: 0 0 10px rgba(0,0,0,0.5); }
        #submit-button:disabled { background-color: #555; cursor: wait; color: #999;}

        @media (min-width: 1024px) {
            #reading-chamber-grid { display: grid; grid-template-columns: 1fr 1.2fr; gap: 40px; align-items: start; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="deck-selection-screen">
             <h1>The Oracle's Veil</h1>
             <p>Focus your mind. Choose your path.</p>
             <div class="deck-choices">
                 <div class="deck-card" id="gold-foil-deck">
                     <div class="deck-info">
                        <h2>Greco-Roman Tarot</h2>
                        <p class="description">Draw wisdom from the pantheon for your modern odyssey.</p>
                     </div>
                     <div class="mode-selection-buttons">
                        <button class="mode-btn" onclick="selectDeck('goldFoil', 'auto')">Ask the Oracle</button>
                        <button class="mode-btn" onclick="selectDeck('goldFoil', 'manual')">Guide the Draw</button>
                     </div>
                 </div>
                 <div class="deck-card" id="dark-tarot-deck">
                      <div class="deck-info">
                        <h2>Demonic Tarot</h2>
                        <p class="description">Unflinching advice from the spirits of the underworld.</p>
                      </div>
                      <div class="mode-selection-buttons">
                        <button class="mode-btn" onclick="selectDeck('darkTarot', 'auto')">Ask the Oracle</button>
                        <button class="mode-btn" onclick="selectDeck('darkTarot', 'manual')">Guide the Draw</button>
                     </div>
                 </div>
             </div>
        </div>

        <div id="reading-chamber-screen">
            <div id="reading-chamber-grid">
                <div id="left-panel">
                    <div id="left-panel-content">
                        <div id="card-display"></div>
                        <div id="manual-selection-container">
                            <h3 id="manual-selection-prompt"></h3>
                            <div id="manual-selection-grid"></div>
                            <button id="confirm-selection-btn" disabled>Confirm Selection</button>
                        </div>
                    </div>
                    <div id="chat-interface">
                        <div id="chat-log"></div>
                        <form id="chat-form">
                            <input type="text" id="user-input" placeholder="Ask your question..." autocomplete="off">
                            <button type="submit" id="submit-button">Ask</button>
                        </form>
                    </div>
                </div>
                <div id="right-panel">
                    <h3 id="spread-name"></h3>
                    <div id="interpretation-area"></div>
                </div>
            </div>
        </div>
    </div>

<script>
    // --- IMPORTANT: AI CONFIGURATION ---
    // WARNING: For this local test, your secret API key is visible below. 
    // Do NOT deploy this file to a public website. For public deployment, the API call 
    // must be handled by a secure backend server to protect your key.
    const apiKey = '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';

    const fullDeckData = {
        major: [
            { name: "The Fool", svg: `<g><path d="M50 10 C 65 10, 70 25, 60 35 M50 20 L 50 80 M40 80 L 60 80 M 60 15 L 70 25 M 65 20 L 60 25 M50 30 L 65 40"/><path d="M30 140 H 70 L 50 150 Z"/></g>`, meanings: { 
                upright: { general: "Represents new beginnings, innocence, and pure potential. It's an encouragement to take a leap of faith, trusting the universe as you step into the unknown.", love: "A new, exciting romantic chapter may be starting. Approach it with fresh, optimistic eyes.", career: "Favorable new opportunities are on the horizon. Be innovative and take a calculated risk.", family: "A new phase in family dynamics, perhaps a birth or a shift that brings fresh energy. Approach with an open heart." }, 
                reversed: { general: "Warns of naivety, recklessness, and a fear of the unknown that's holding you back. A call for caution and balance.", love: "Exercise caution in relationships. You may be ignoring obvious red flags or letting fear of commitment sabotage a connection.", career: "Re-evaluate your career plans. An impulsive decision could be disastrous.", family: "Reckless decisions may be causing instability at home. Alternatively, fear is preventing a necessary family change." },
                blunt: "A new path is open, but it requires a leap of faith. Your next step is to either embrace the uncertainty with optimism or, if reversed, to pause and assess the risks before acting recklessly. What does your gut, not your fear, tell you to do?" } },
            { name: "The Magician", svg: `<g><path d="M50 20 V 120 M 30 120 H 70"/><path d="M 45 20 L 55 10 M 50 20 L 50 5"/><circle cx="50" cy="50" r="20" /><path d="M30 40 L 70 60"/><path d="M50 15 L 50 -10"/></g>`, meanings: {
                upright: { general: "Symbolizes manifestation, willpower, and resourcefulness. The Magician has all the tools and talents to transform ideas into reality.", love: "You have the power and charm to create the relationship you desire. It's time for clear communication and proactive efforts.", career: "A powerful sign for career advancement. Use your skills to start new projects, ask for a promotion, or launch a business.", family: "You are the key figure in making family plans happen. Your ability to organize and act brings everyone together." },
                reversed: { general: "Warns of manipulation, deception, and untapped potential. Your energy is unfocused, or your skills are being used for trickery.", love: "Be wary of manipulation or insincerity in a relationship. Hidden agendas and dishonesty create illusions that will shatter.", career: "A lack of clear career goals or a misuse of your talents. Schemes designed to get ahead will backfire.", family: "Someone in the family may be using manipulation to get what they want, or a lack of focused effort is letting family responsibilities slide." },
                blunt: "You possess all the tools needed for success. The immediate task is to create a clear, actionable plan and execute it. If reversed, your first step is to act with integrity and refocus your scattered energy on a single, honest goal." } },
            { name: "The High Priestess", svg: `<g><rect x="20" y="20" width="15" height="120" /><rect x="65" y="20" width="15" height="120" /><circle cx="50" cy="60" r="10"/><path d="M40 70 C 50 90, 60 70, 50 60 C 40 70, 50 90, 60 70z"/><path d="M45 100 v 20 h 10 v -20 z M 40 145 a 10 10 0 0 1 20 0 z"/></g>`, meanings: {
                upright: { general: "Represents intuition, subconscious wisdom, and mystery. She holds secret knowledge and urges you to look inward for answers.", love: "There is a deep, intuitive connection at play. Trust your instincts about a person or situation; the truth is not yet fully revealed.", career: "Rely on your gut instincts in career decisions. This may be a period of study, research, or quiet contemplation.", family: "There are unspoken truths within the family. Trust your intuition about family dynamics; not everything is out in the open." },
                reversed: { general: "Signifies repressed intuition and hidden motives. You are ignoring your inner voice in favor of logic or external opinions, leading to confusion.", love: "A lack of emotional honesty is causing problems. Hidden feelings or a refusal to trust your intuition can lead to deep misunderstandings.", career: "You're ignoring your intuition about a work situation, which is causing stress. Seek clarity from within.", family: "Ignoring your gut feeling about a family matter is leading to confusion. Secrets may be causing harm." },
                blunt: "The solution you seek is not in the external world. Carve out quiet time for reflection, meditation, or journaling. Your intuition already holds the answer, you just need to create the silence to hear it." } },
            { name: "The Empress", svg: `<g><circle cx="50" cy="30" r="15" /><path d="M35 45 C 20 80, 80 80, 65 45"/><path d="M40 70 v 50 h 20 v -50 M30 140 H 70"/><path d="M20 70 v 30 h 10"/><path d="M80 70 v 30 h -10"/><circle cx="80" cy="30" r="5"/><path d="M77 27 v10 M83 27 v 10 M75 30 h 10"/></g>`, meanings: {
                upright: { general: "Symbolizes fertility, nurturing, and abundance. She is the archetype of the mother, representing creativity and a deep connection to the natural world.", love: "A period of deep, nurturing love and commitment. Affection and care are abundant.", career: "Creative projects are flourishing. This is a time of financial abundance and growth.", family: "The heart of the family. This card represents a period of loving care, domestic harmony, and potentially the expansion of the family." },
                reversed: { general: "Indicates creative blocks, dependency, and a smothering or neglectful energy. It can also point to an imbalance of nurturing vs. control.", love: "Imbalances in the relationship are causing problems. One partner may be overly possessive, smothering, or, conversely, neglectful.", career: "Financial difficulties or creative blocks at work. You may feel unfulfilled and stagnant.", family: "Family dynamics feel smothering or neglectful. Self-care may be ignored in favor of 'mothering' others, or there's a disconnect from home." },
                blunt: "Focus on nurturing yourself and your projects. To improve this situation, engage your senses, connect with nature, or practice generosity. If feeling smothered (Reversed), establish healthy boundaries. If feeling neglectful, schedule time for self-care." } },
            { name: "The Emperor", svg: `<g><rect x="25" y="40" width="50" height="90" /><path d="M50 10 L 25 40 M 50 10 L 75 40"/><path d="M25 40 h 50 M25 70 h 50 M25 100 h 50"/><circle cx="50" cy="70" r="10" /><path d="M30 30 c 0-10 10-10 10-10 s 10 0 10 10"/><path d="M50 30 c 0-10 10-10 10-10 s 10 0 10 10"/></g>`, meanings: {
                upright: { general: "Represents authority, structure, stability, and control. He is the father archetype, providing order and discipline.", love: "This card points to a stable, committed, and traditional relationship. It can also indicate the need to establish clearer boundaries.", career: "A time for leadership, strategic planning, and organization. You are in a position of authority or are being called to take one.", family: "A patriarchal figure or energy is dominant. This brings stability and structure, but requires clear rules and boundaries for family harmony." },
                reversed: { general: "Warns of tyranny, rigidity, and an abuse of power. It can also indicate a complete lack of control and discipline.", love: "Control issues are plaguing the relationship. One partner is being overly domineering.", career: "A tyrannical boss or a chaotic, disorganized work environment is causing problems.", family: "Power struggles or a domineering family member are creating conflict. This is a rigid, unhappy household lacking flexibility." },
                blunt: "This situation calls for structure and discipline. Create a solid plan with clear rules and follow it. If reversed, your task is to lead with compassion instead of force, or to establish boundaries against a tyrannical figure." } },
            { name: "The Hierophant", svg: `<g><path d="M50 15 v 100 M 35 115 H 65 M30 35 h 40 M30 55 h 40"/><circle cx="50" cy="45" r="10"/><path d="M25 120 v -20 h 10 v 20 M65 120 v -20 h 10 v 20"/></g>`, meanings: {
                upright: { general: "Symbolizes tradition, conformity, and established institutions. It represents a spiritual guide or mentor who imparts wisdom from a proven system.", love: "This often points to a traditional relationship path, including commitment and marriage, and sharing core values.", career: "Work within an established organization with a clear hierarchy. Success comes from playing by the book.", family: "Represents family traditions, shared beliefs, and established roles. It can point to a formal family event or seeking conventional guidance." },
                reversed: { general: "Signifies rebellion against tradition and non-conformity. You are challenging established norms and forging your own path.", love: "You are questioning traditional relationship structures or breaking free from a restrictive partnership.", career: "Time to challenge the status quo at work. You might leave a rigid corporate structure or introduce innovative, disruptive ideas.", family: "Challenging family traditions and outdated beliefs. You are forging your own path, separate from family expectations." },
                blunt: "Seek guidance from a trusted mentor or proven system. There is value in the traditional path now. If you're rebelling (Reversed), ensure you're doing so with a clear purpose, not just for the sake of breaking rules." } },
            { name: "The Lovers", svg: `<g><path d="M25 60 C 20 80, 40 100, 35 120 M 25 60 l 10-30 10 30 M75 60 C 80 80, 60 100, 65 120 M 75 60 l -10-30 -10 30" /><path d="M50 10 L 40 25 h 20 L 50 10 Z"/><path d="M40 25 C 50 40, 60 25, 50 25"/></g>`, meanings: {
                upright: { general: "Represents choices, relationships, and alignment of values. A significant decision that must be made from the heart.", love: "A deep, soulmate-level connection. A choice about the relationship is at hand, based on authentic love and shared values.", career: "A choice between two career paths or a partnership in business. Make your decision based on what aligns with your core values.", family: "A choice that affects the entire family, requiring a united front. It's about aligning family values to make the best decision for the group." },
                reversed: { general: "Signifies disharmony, poor choices, and a misalignment of values. There is conflict and indecision.", love: "Conflict and disharmony are present in your relationship. You and your partner are not on the same page, or you are feeling indecisive.", career: "Conflict in a business partnership or a bad career decision. Your work may not be aligned with what you truly value.", family: "Family values are in conflict. A poor choice has created disharmony and discord among family members." },
                blunt: "A critical choice is before you. To move forward, clearly define your core values and make the decision that aligns with them, even if it's difficult. Ignoring your inner truth (Reversed) will only lead to further conflict." } },
            { name: "The Chariot", svg: `<g><rect x="20" y="70" width="60" height="60"/><circle cx="35" cy="100" r="10"/><circle cx="65" cy="100" r="10"/><path d="M50 30 v 60 M40 50 h 20"/><path d="M25 70 C 15 80, 15 110, 25 120"/><path d="M75 70 C 85 80, 85 110, 75 120"/></g>`, meanings: {
                upright: { general: "Symbolizes willpower, determination, and victory. It is about taking control of opposing forces and driving forward with focus.", love: "You are taking control of your love life and driving the relationship toward a specific goal. Success comes from both partners being aligned.", career: "A time of great ambition and drive. You are overcoming obstacles at work and moving towards a significant victory.", family: "Taking charge of the family's direction. Your willpower is moving the family unit forward toward a common goal, despite internal or external opposition." },
                reversed: { general: "Indicates a lack of direction, aggression, and loss of control. Your energy is scattered, and obstacles are blocking your path.", love: "A lack of direction or control issues are causing conflict in the relationship. You or your partner may be acting aggressively.", career: "Stagnation in your career. You lack the direction to move forward, or you are pushing too hard.", family: "The family is being pulled in different directions at once. A lack of unified goals or aggressive power plays are causing chaos." },
                blunt: "Unify your conflicting desires and set a single, clear goal. Success now requires absolute focus and determination. If reversed, stop trying to force your will; pause, create a strategy, and then proceed with control, not aggression." } },
            { name: "Strength", svg: `<g><circle cx="35" cy="60" r="15"/><path d="M35 75 C 20 120, 50 120, 35 75 Z"/><path d="M60 70 C 70 70, 80 80, 80 90 s -10 20 -20 20 s-20 -10 -20 -20"/><path d="M50 80 h 20"/><path d="M40 30 h 30 v-10 h-30z"/></g>`, meanings: {
                upright: { general: "Represents inner strength, courage, patience, and compassion. It is about taming one's primal urges not with force, but with gentle persuasion.", love: "A relationship built on deep passion that is managed with compassion and patience. You have the courage to be vulnerable.", career: "You have the inner fortitude to handle a high-pressure situation at work. You can influence others by being confident and compassionate.", family: "Handling difficult family dynamics with patience and gentle strength. Your compassion can tame even the most volatile situations at home." },
                reversed: { general: "Indicates weakness, self-doubt, and a lack of self-control. Raw, uncontrolled emotions are taking over.", love: "Insecurity and self-doubt are creating problems like jealousy, neediness, or emotional outbursts.", career: "You feel weak and lack confidence at work. This self-doubt may be causing you to shy away from challenges.", family: "Raw emotions and impulse are causing family fights. A lack of self-control is leading to hurtful arguments and instability." },
                blunt: "Your greatest power now is compassion and patience, not force. Face your inner fears or a difficult situation with gentle courage. If feeling weak (Reversed), your first step is to practice self-compassion to rebuild your inner strength." } },
            { name: "The Hermit", svg: `<g><path d="M50 40 L 50 130 M 40 130 h 20" /><path d="M50 40 L 60 50 M 50 40 L 40 50"/><rect x="65" y="60" width="10" height="20" /><path d="m 70 60 l 10-10 m-10 20 l 10 10 m 65 60 l 10 0 m 65 80 l 10 0"/></g>`, meanings: {
                upright: { general: "Symbolizes introspection, soul-searching, and solitude. The Hermit withdraws from the world to seek inner wisdom.", love: "A period of solitude is needed. If single, for self-discovery. If in a relationship, you may need space for personal reflection.", career: "Take a step back to re-evaluate your career path. This may be a time for research, solo projects, or seeking guidance from a mentor.", family: "Feeling the need for space from family obligations to find your own path. This is a time of personal searching, away from family influence." },
                reversed: { general: "Indicates a forced isolation or a fear-based withdrawal. You are either overly isolated or are stubbornly refusing to seek help.", love: "You feel emotionally isolated, even if you are in a relationship. A fear of intimacy is creating distance.", career: "You may feel isolated at work or are stubbornly refusing to collaborate with others, which is hindering your progress.", family: "Loneliness within the family, or cutting yourself off from them out of stubbornness or fear. This is not healthy soul-searching, but painful isolation." },
                blunt: "You need time alone to think. Detach from the noise and opinions of others to find your own truth. If you're already isolated (Reversed), the next step is to reach out and share what you've learned or ask for help." } },
            { name: "Wheel of Fortune", svg: `<g><circle cx="50" cy="80" r="40"/><circle cx="50" cy="80" r="10"/><path d="M50 40 v80 M10 80 h80 M20 50 l60 60 M20 110 l60-60"/><path d="M10 30 h 20 v-20 h-20z"/><path d="M70 30 h 20 v-20 h-20z"/></g>`, meanings: { 
                upright: { general: "Represents cycles, destiny, and turning points. Often signals good luck and a shift in a positive direction.", love: "A significant turning point in your relationship is imminent. Destiny may be bringing a new person into your life.", career: "Expect unexpected opportunities and a change in your career or financial situation.", family: "A significant change in the family's fortunes or circumstances is imminent. This turning point is largely out of your control." }, 
                reversed: { general: "Indicates bad luck, negative cycles, and resistance to change. You may be feeling out of control as unexpected setbacks disrupt your plans.", love: "A negative pattern is repeating in your love life. You may be resisting a necessary change.", career: "A negative turn in your career or financial instability. You feel like luck is against you.", family: "A period of bad luck for the family, or resisting a necessary change in the family structure is causing problems." },
                blunt: "Change is coming, and it's outside your control. Your best move is to be adaptable and ready to seize the opportunity this turn presents. If the cycle feels negative (Reversed), do not resist; find the lesson in the downturn to break the pattern." } },
            { name: "Justice", svg: `<g><path d="M50 10 v 50" /><path d="M20 60 h 60" /><path d="M20 50 L 50 70 L 80 50"/><path d="M50 75 L 50 140 M 35 130 H 65"/></g>`, meanings: {
                upright: { general: "Symbolizes fairness, truth, and the law of cause and effect (karma). It indicates that a fair and just decision will be made.", love: "A time for honesty and fairness in your relationship. A balanced give-and-take is essential.", career: "Ethical behavior and fairness are paramount. This card can relate to legal contracts or disputes, which will be resolved justly.", family: "The truth of a family matter is being revealed. It's time for accountability and for past actions to have their consequences, for better or worse." },
                reversed: { general: "Indicates injustice, dishonesty, and a lack of accountability. You may be facing an unfair situation or are avoiding the consequences of your own actions.", love: "Dishonesty or unfairness is creating imbalance in your relationship. One partner is not being held accountable.", career: "Workplace injustice, such as a biased decision or being falsely accused. Legal matters are likely to be delayed.", family: "An unfair situation within the family is causing resentment. Someone is not taking responsibility for their actions, and truth is being hidden." },
                blunt: "Seek the objective truth of the matter. Make a decision based on facts and fairness, not emotion. Take responsibility for your part, and you'll find clarity. If you're being dishonest (Reversed), the only way forward is to come clean." } },
            { name: "The Hanged Man", svg: `<g><path d="M20 20 H 80"/><path d="M50 20 V 90" /><path d="M50 90 L 60 110 L 40 110 L 50 90 Z"/><path d="M50 90 L 40 70 M 50 90 L 60 70"/><path d="M50 110 L 50 130"/></g>`, meanings: {
                upright: { general: "Represents a pause, surrender, and gaining a new perspective. It is a card of voluntary sacrifice and reflection, leading to enlightenment.", love: "It's time to pause and look at your relationship from a new angle. Sacrificing your ego could be what saves the partnership.", career: "Put your projects on hold. A period of waiting and reassessing your career path is necessary.", family: "A stalemate in family matters requires you to surrender your viewpoint. The situation is paused until you can see it differently." },
                reversed: { general: "Warns of stalling, resistance to change, and needless sacrifice. You are stuck because you are refusing to let go.", love: "The period of waiting is over, and you are refusing to take action. You are stuck in a relationship out of a sense of martyrdom.", career: "You are stalling on a career decision out of fear. Your projects are stuck, and you are resisting a new approach.", family: "You're stuck in a family dynamic out of a false sense of duty. Your resistance to letting go is causing stagnation for everyone." },
                blunt: "You are stuck. Stop pushing. The path forward will only appear when you willingly let go of your current perspective and surrender control for a moment. This is a time for active waiting, not pointless struggle (Reversed)." } },
            { name: "Death", svg: `<g><circle cx="50" cy="50" r="15" /><path d="M40 50 h20 M50 40 v20"/><path d="M50 65 V 130"/><path d="M50 130 L 30 110 M 50 130 L 70 110 M50 130 L 30 145 M50 130 L 70 145"/><path d="M20 135 H 80"/></g>`, meanings: {
                upright: { general: "Symbolizes endings, transformation, and transition. The end of a major chapter to make way for a profound new beginning.", love: "The end of a relationship or a major phase within it. This ending is necessary for both parties to grow.", career: "The end of a job or career path. This change is clearing the way for a new professional chapter.", family: "A major, unavoidable change in the family structure. An old way of life is ending, making way for something new." },
                reversed: { general: "Indicates a powerful resistance to a necessary ending. You are clinging to the past and afraid of change, which is causing suffering.", love: "You are clinging to a relationship that needs to end. Your fear is prolonging the pain for everyone involved.", career: "You are resisting a necessary career change, perhaps staying in a dead-end job out of fear.", family: "Fighting a necessary change in the family is causing immense pain. You are preventing the family unit from healing and evolving." },
                blunt: "A necessary ending is upon you. Your best course of action is to let go of what is leaving to make space for what is coming. Resisting this change (Reversed) will only prolong the pain; acceptance is the first step toward your rebirth." } },
            { name: "Temperance", svg: `<g><path d="M40 20 L 60 40 M45 45 l5 -5" /><rect x="35" y="45" width="30" height="30" /><path d="M60 90 L 40 110"/><rect x="35" y="110" width="30" height="30" /><path d="M50 75 v 15 M50 110 v -10"/><path d="M50 30 c 15 0 15 30 0 30 c -15 0 -15-30 0-30"/></g>`, meanings: {
                upright: { general: "Represents balance, moderation, and patience. It is the card of alchemy, about blending opposing forces to create something new.", love: "A harmonious and balanced relationship. You and your partner are blending your energies beautifully.", career: "A balanced approach to work and finance is key. Long-term goals are achieved through steady, patient, and moderate action.", family: "Finding a harmonious middle ground in family conflicts. This card brings peace and compromise to domestic life." },
                reversed: { general: "Indicates imbalance, excess, and a lack of patience. You are dealing in extremes, which is causing discord and recklessness.", love: "Imbalance and conflict are stressing the relationship. One or both partners may be acting in extremes or with impatience.", career: "Your work-life balance is completely off. Impulsive financial decisions or a reckless approach to projects is creating instability.", family: "The family dynamic is out of balance. Extreme viewpoints and a lack of patience are creating conflict and unhappiness." },
                blunt: "The key to progress is moderation and patience. Look for the middle path between extremes in your life. Instead of drastic action, take a calm, balanced approach. This is not the time for haste or overindulgence (Reversed)." } },
            { name: "The Devil", svg: `<g><path d="M40 30 c-10-10 10-20 20 0 M60 30 c10-10 -10-20 -20 0" /><circle cx="50" cy="50" r="10"/><path d="M50 60 v 40 M30 130 h 40"/><path d="M20 100 l-10 10 M20 110 l10 10 M80 100 l10 10 M80 110 l-10 10"/></g>`, meanings: {
                upright: { general: "Symbolizes bondage, addiction, and materialism. It points to a situation where you feel trapped by your own negative patterns or temptations.", love: "An unhealthy, codependent, or obsessive relationship. There may be issues of jealousy, control, or a connection based on lust.", career: "Feeling trapped in a job you hate for the money. It can also point to unethical practices or being in debt.", family: "A toxic family dynamic of codependency, control, or manipulation. This family is bound by guilt and obligation, not love." },
                reversed: { general: "Signifies breaking free from restrictions and reclaiming your power. You are releasing yourself from addiction or negative patterns.", love: "You are breaking free from a toxic or codependent relationship. You are recognizing your own power.", career: "You are leaving an oppressive job or breaking free from financial constraints.", family: "Recognizing and breaking free from a toxic family pattern. This is a major step toward personal liberation from unhealthy family ties." },
                blunt: "Confront the negative pattern or attachment that is holding you captive. Your first step to freedom is to be radically honest with yourself about the situation. You hold the key to your own chains; it's time to use it." } },
            { name: "The Tower", svg: `<g><rect x="35" y="50" width="30" height="100" /><path d="M35 50 L 50 30 L 65 50" /><path d="M70 20 L 50 60 L 80 50" /><path d="M25 80 c 5 10 15 10 20 0 M 60 110 c 5-10 -5 -15 -10 -5"/></g>`, meanings: {
                upright: { general: "A sudden, dramatic, and often chaotic upheaval. This card represents the destruction of false structures, beliefs, and illusions.", love: "An abrupt end to a relationship or a shocking revelation that shatters the foundation of your partnership.", career: "Unexpected job loss, the collapse of a business, or a major crisis at work.", family: "A sudden, shocking event that shatters the family's sense of security. A family secret may be revealed, changing everything." },
                reversed: { general: "You are avoiding a necessary disaster. By clinging to a situation that is no longer stable, you are only delaying the inevitable.", love: "You are staying in a relationship that you know is doomed. You are trying to patch up a crumbling foundation out of fear.", career: "You can see a major problem at work but are trying to ignore it. This refusal to act is preventing a cleansing change.", family: "A refusal to face a brewing family crisis is making the inevitable fallout even worse. The illusion of peace is about to shatter." },
                blunt: "This is a moment of necessary, radical change. Don't fight to preserve what's crumbling. Instead, focus on protecting what's most important and prepare to rebuild on a foundation of truth. Your resilience is key." } },
            { name: "The Star", svg: `<g><path d="M50 15 L 55 35 H 75 L 60 45 L 65 65 L 50 55 L 35 65 L 40 45 L 25 35 H 45 Z" /><path d="M50 70 V 130"/><path d="M20 130 H 80"/><path d="M40 90 c -10 10 -20 0 -20-10"/><path d="M60 90 c 10 10 20 0 20-10"/></g>`, meanings: {
                upright: { general: "Represents hope, inspiration, and serenity. After the storm of the Tower, this card is a tranquil sigh of relief and healing.", love: "Renewed hope in your love life. After a difficult period, healing is possible. A serene, inspiring, and authentic connection.", career: "You feel inspired and hopeful about your career path. A great time for creative projects.", family: "A period of healing and peace is returning to the family after a crisis. There is renewed hope for harmonious relationships." },
                reversed: { general: "Indicates despair, a lack of faith, and discouragement. You are feeling hopeless and disconnected from your inner guidance.", love: "You're feeling pessimistic about your love life or a specific relationship. The spark has gone, and you lack faith in a positive future.", career: "Feeling discouraged and uninspired at work. Your career feels like a dead end.", family: "A feeling of hopelessness hangs over the family. Faith in each other and in a happy future is at an all-time low." },
                blunt: "The storm has passed. Your task now is to heal and reconnect with hope. Nurture your spirit and have faith in the future. If hope feels distant (Reversed), find one small thing to be grateful for to begin shifting your perspective." } },
            { name: "The Moon", svg: `<g><path d="M80 50 A 30 30 0 1 1 50 20" /><rect x="20" y="70" width="15" height="70"/><rect x="65" y="70" width="15" height="70"/><path d="M30 110 L 45 90 M40 120 L 55 100"/><path d="M60 110 l10 -20 h 10"/></g>`, meanings: {
                upright: { general: "Symbolizes illusion, fear, and the subconscious. Things are not as they seem. You must face your hidden fears and trust your gut.", love: "Uncertainty and illusion are clouding your relationship. There may be unexpressed fears or deception at play.", career: "Confusion about your career path. A project may involve unclear information or hidden elements.", family: "Deep-seated family anxieties and secrets are surfacing. Things are not what they seem on the surface; trust your intuition to navigate the murky emotions." },
                reversed: { general: "The confusion is beginning to clear. You are releasing your fears, and secrets are being revealed.", love: "Clarity is returning to your relationship. Deceptions are revealed, or you are overcoming your own anxieties.", career: "Clarity about your career path is emerging. Misinformation is being corrected.", family: "Clarity is finally coming to a confusing family situation. Secrets may be coming to light, allowing for fear to be released." },
                blunt: "Do not trust what you see; trust your intuition. This is a time to explore your anxieties and dreams to understand what's really going on beneath the surface. Action should be cautious and guided by your gut feelings." } },
            { name: "The Sun", svg: `<g><circle cx="50" cy="40" r="25"/><path d="M50 15 v-10 M50 65 v 10 M25 40 h-10 M75 40 h10 M32 22 l-7-7 M68 58 l7 7 M32 58 l-7 7 M68 22 l7-7"/><path d="M50 90 l-10 20 h20 l-10 -20 z M 30 140 H 70"/></g>`, meanings: {
                upright: { general: "Represents joy, success, and vitality. This is a time of enlightenment, optimism, and pure happiness.", love: "A joyful and happy relationship. This is a time of warmth, harmony, and fun. Your connection is a source of great positivity.", career: "A period of great success and recognition at work. You are achieving your goals and feeling optimistic about your career.", family: "A time of immense joy, harmony, and celebration within the family. Everything is out in the open, and the atmosphere is happy and loving." },
                reversed: { general: "Indicates a lack of enthusiasm and pessimism. You may be struggling to find the joy in life, or your judgment may be clouded.", love: "The joy has temporarily faded from your relationship. Pessimism or a lack of enthusiasm is creating a cloud.", career: "Setbacks at work or a lack of enthusiasm for your career. Your achievements may feel hollow.", family: "The joy is missing from family life. Simple conflicts or a general pessimism are clouding what should be a happy time." },
                blunt: "This is a moment of pure clarity and success. Your action is to embrace it fully and share your joy. Don't overthink it or look for problems where there are none. Let yourself be happy and shine." } },
            { name: "Judgement", svg: `<g><rect x="20" y="100" width="20" height="40"/><rect x="60" y="100" width="20" height="40"/><path d="M50 20 L 40 40 h20 z" /><path d="M50 40 V 80 H 60 V 50"/><path d="M40 100 v -20 M80 100 v-20 M30 90 h 40"/></g>`, meanings: {
                upright: { general: "Symbolizes a reckoning, an awakening, and a rebirth. This is a time of self-evaluation and making a significant, life-altering decision.", love: "A critical turning point in a relationship. It's time to make a final judgment about the partnership, involving honest communication.", career: "A major career change or realization. You are evaluating your professional life and heeding an inner calling to a more authentic path.", family: "A time of reckoning for the family. Past actions are being judged, leading to forgiveness and a potential 'rebirth' of family relationships on a more honest level." },
                reversed: { general: "Warns of self-doubt and ignoring a critical inner calling. You are paralyzed by a fear of change or are being overly critical.", love: "You are avoiding a necessary conversation or decision in your relationship out of self-doubt.", career: "Self-doubt is hindering your career. You are ignoring your true calling or are too afraid to make a pivotal move.", family: "Refusing to forgive past wrongs or making harsh judgments is preventing the family from healing. Everyone is stuck in a cycle of blame." },
                blunt: "A major life decision is required. To move forward, you must assess your past actions, forgive yourself and others, and answer your true calling. Avoiding this judgment (Reversed) is the cause of your stagnation." } },
            { name: "The World", svg: `<g><ellipse cx="50" cy="80" rx="45" ry="30" /><path d="M50 80 c -10 -20 10 -20 0 0 c -10 20 10 20 0 0 Z"/><path d="M20 20 h10 v10 h-10z"/><path d="M70 20 h10 v10 h-10z"/><path d="M20 130 h10 v10 h-10z"/><path d="M70 130 h10 v10 h-10z"/></g>`, meanings: {
                upright: { general: "Represents successful completion, integration, and accomplishment. You have reached the end of a major life cycle.", love: "The successful completion of a relationship cycle. This could mean a committed, harmonious long-term partnership or peaceful closure.", career: "You have reached a significant goal in your career. This represents success, accomplishment, and recognition.", family: "The family unit feels whole, complete, and successful. A major family cycle has come to a positive and fulfilling conclusion." },
                reversed: { general: "Indicates a lack of completion and a feeling of stagnation. There is a missing piece of the puzzle, leading to a lack of closure.", love: "A relationship feels incomplete or stagnant. You are avoiding the work needed to take the partnership to the next level of completion.", career: "A project is left unfinished, or you feel stagnant and unfulfilled in your career.", family: "A sense that the family is not 'whole'. A chapter is left unfinished, preventing a true sense of closure or fulfillment for the family unit." },
                blunt: "You have reached a point of successful completion. Your task is to pause, celebrate your achievement, and integrate the lessons learned. If something feels incomplete (Reversed), identify the final step you've been avoiding and finish it." } }
        ],
        wands: [
            // ... [All wand meanings remain the same] ...
            { name: "Ace of Wands", svg: `<path d="M 40 140 v -100 a 10 10 0 0 1 20 0 v 100 M 50 20 l 10 10 m -10 -10 l -10 10" />`, meanings: {
                upright: { general: "A surge of new energy, inspiration, and potential. It's a call to take swift, bold action on a new opportunity.", love: "A spark of new romance or a burst of renewed passion in an existing relationship.", career: "The beginning of a new, exciting project or job. Seize this opportunity with confidence.", family: "A burst of new energy enters the family. It's a great time to start a new family project or tradition with enthusiasm." },
                reversed: { general: "Delays, creative blocks, and a lack of passion. An opportunity may have been missed or failed to launch.", love: "A lack of excitement or passion in your love life. The spark is missing.", career: "Creative blocks are hindering your progress at work. A new project is delayed or cancelled.", family: "A new family initiative has fizzled out due to a lack of energy or enthusiasm. General apathy is present." },
                blunt: "You have a brilliant new idea or surge of passion. Act on it now, or the fire will go out." } },
            { name: "Two of Wands", svg: `<path d="M 30 140 V 20 M 70 140 V 20 M 50 80 a 10 10 0 1 1 0 -0.01" />`, meanings: { 
                upright: { general: "Represents future planning, decision-making, and progress. You have moved past the initial idea and are now contemplating your long-term goals.", love: "You are planning a future with a partner, making long-term decisions together.", career: "A time for long-term career planning and exploring opportunities for expansion, possibly overseas.", family: "Making long-term plans for the family's future, such as moving or planning a major family event. It's about looking to the horizon together." },
                reversed: { general: "Indicates indecisiveness, a fear of the unknown, and a lack of planning. Your plans are delayed, and you feel stuck due to doubt or impatience.", love: "Fear of the unknown is creating hesitation in your love life. You may be uncertain about a long-term future with your partner.", career: "A lack of clear planning is hindering your career growth. You may be afraid to leave your comfort zone for a better opportunity.", family: "A lack of long-term planning for the family is causing instability. Fear of change is preventing the family from moving forward." },
                blunt: "You'vehad the idea, now you need a long-term plan. Step out of your comfort zone and decide, or stay stuck." } },
            { name: "Three of Wands", svg: `<path d="M 25 140 V 20 M 50 140 V 20 M 75 140 V 20" />`, meanings: {
                upright: { general: "Represents expansion, foresight, and momentum. Your plans are now in motion, and the first signs of success are appearing on the horizon.", love: "Your relationship is moving forward with positive momentum. You and your partner are on the same page and expanding your future together.", career: "Your hard work is beginning to pay off. Business ventures are showing signs of growth, and opportunities for expansion are becoming visible.", family: "Family plans are successfully in motion, showing the first signs of positive results. Keep looking ahead with confidence." },
                reversed: { general: "Signifies restrictions, delays, and a lack of progress. You may be frustrated that your plans are not materializing as expected.", love: "Progress in your relationship has stalled. You and your partner may be heading in different directions or facing unexpected obstacles.", career: "Setbacks and delays are frustrating your career plans. An expected opportunity may not have materialized.", family: "Family plans have hit a snag. Frustration is growing due to unexpected obstacles or a lack of forward momentum." },
                blunt: "Your plans are in motion and showing early promise. Be confident. If reversed, your progress is blocked; re-evaluate your strategy." } },
            { name: "Four of Wands", svg: `<path d="M 20 140 V 40 M 80 140 V 40 M 20 40 Q 50 10, 80 40 M 30 50 H 70" />`, meanings: {
                upright: { general: "Represents celebration, harmony, and stability. This is a joyful card of homecoming, reunions, and reaching a significant milestone.", love: "A time of celebration in your relationship, such as an engagement, wedding, or anniversary. It points to a stable, harmonious partnership.", career: "A significant milestone has been achieved at work. This is a time for celebration with your colleagues.", family: "A card of joyful family gatherings, reunions, and celebrations. It signifies a stable, harmonious home life." },
                reversed: { general: "Indicates instability and a lack of harmony, often within family or community. A celebration may be canceled or feel tense.", love: "Conflict and instability within your relationship or family. The harmony is disrupted.", career: "A tense and unsupportive work environment. Conflicts with colleagues or a lack of teamwork are causing instability.", family: "Tension and conflict are marring what should be a happy family time. There is instability in the home." },
                blunt: "You've achieved a milestone worth celebrating. Enjoy the harmony and stability you've created." } },
            { name: "Five of Wands", svg: `<path d="M20 40 L 80 120 M 20 120 L 80 40 M 50 30 V 130 M 30 80 L 70 80 M 35 55 L 65 105" />`, meanings: {
                upright: { general: "Symbolizes conflict, competition, and disagreements. There are a lot of clashing egos and different ideas, creating a state of tension and struggle.", love: "You and your partner are in a state of conflict. There are frequent arguments and a lack of harmony.", career: "A highly competitive work environment. You may be in conflict with colleagues, all vying for the same position.", family: "Represents family squabbles and disagreements. Clashing personalities and egos are creating chaos and tension." },
                reversed: { general: "Signifies the end of conflict and a move toward harmony and cooperation. It can also point to a deep internal conflict.", love: "The arguments are ending, and you are finding a way to compromise. Be wary of avoiding necessary conflict for superficial peace.", career: "Workplace conflicts are being resolved, leading to a more cooperative environment. You are learning to work with difficult colleagues.", family: "An end to family conflicts is near. This can mean finding a resolution or that family members are simply tired of fighting." },
                blunt: "This is about competition and conflict. It's a chaotic struggle. Either learn to cooperate or get lost in the noise." } },
            { name: "Six of Wands", svg: `<path d="M 50 140 V 20 M 50 20 L 40 40 M 50 20 L 60 40 M 40 20 a 10 10 0 1 1 20 0 a 10 10 0 1 1 -20 0" />`, meanings: {
                upright: { general: "Represents victory, success, and public recognition. You have overcome the challenges and are now being praised for your achievements.", love: "You and your partner are a 'power couple.' Your relationship is seen as successful and is admired by others.", career: "A major success at work. You are receiving a promotion, a raise, or public recognition for a job well done.", family: "A proud family moment. A member's achievement brings praise and recognition to the whole family." },
                reversed: { general: "Indicates failure, a lack of recognition, and self-doubt. You may have faced a setback, or your achievements have gone unnoticed.", love: "You are feeling unappreciated or that your relationship is a failure. Self-doubt and negativity are creeping in.", career: "You were passed over for a promotion or your hard work has not been recognized. This leads to a lack of confidence.", family: "A sense of failure or shame within the family. An achievement may have fallen short, or praise was expected but not given." },
                blunt: "You've earned this victory and public recognition. Enjoy the success. Don't let arrogance tarnish it." } },
            { name: "Seven of Wands", svg: `<g><path d="M50 20v120" /><path d="M25 80l25-20l25 20" /><path d="M20 90l30-20l30 20" /><path d="M15 100l35-20l35 20" /></g>`, meanings: {
                upright: { general: "Symbolizes challenge, perseverance, and defending your position. You must stand your ground and fight for what you believe in.", love: "You may need to defend your relationship against outside criticism or fight for your needs within the partnership.", career: "You are being challenged at work and must defend your ideas, your position, or your project. Persevere with courage.", family: "Defending your position or beliefs against family pressure. It's about standing your ground for your personal values." },
                reversed: { general: "Represents feeling overwhelmed, giving up, and exhaustion. You are tired of fighting and may be on the verge of surrendering.", love: "You feel overwhelmed by the challenges in your relationship and are tired of fighting. It might be time to compromise or surrender.", career: "You feel overwhelmed at work and are ready to give up on a project or even your job. You lack the self-belief to continue.", family: "You feel exhausted by family conflict and are ready to give in. You may feel like you're fighting a losing battle against them." },
                blunt: "You are being challenged. Stand your ground and defend your position. Giving up now means losing everything." } },
            { name: "Eight of Wands", svg: `<g><path d="M80 30L20 60m60 0L20 90m60 0L20 120m-5-95l65 30m-65 0l65 30m-65 0l65 30" /></g>`, meanings: {
                upright: { general: "Represents swift action, rapid progress, and communication. Things are moving forward quickly, and events are unfolding at a high speed.", love: "Your relationship is moving forward at a rapid pace. This can be exciting and whirlwind-like.", career: "A project is moving forward very quickly with positive momentum. Expect rapid progress and important news related to your work.", family: "Events in the family are moving quickly. Important news may be arriving, or family plans are suddenly accelerating." },
                reversed: { general: "Signifies delays, frustration, and a lack of progress. Things are moving slowly, or you have missed an opportunity due to hesitation.", love: "Progress in your relationship has slowed to a frustrating crawl. There may be communication delays.", career: "Projects are delayed, and you are feeling frustrated by the lack of speed. You may have acted too hastily and are now facing consequences.", family: "Family plans have ground to a halt. Miscommunication and delays are causing frustration for everyone involved." },
                blunt: "Things are moving very quickly. Act now and ride the momentum. Delays or hesitation will cause you to miss out." } },
            { name: "Nine of Wands", svg: `<g><path d="M50 20v120" /><path d="M20 40h60v80h-60z" /></g>`, meanings: {
                upright: { general: "Represents resilience, perseverance, and courage. You are battle-weary but still standing, ready for one final challenge.", love: "You have been through a lot in your relationship, and you are wary but resilient. Guard your heart while still being determined.", career: "You are close to finishing a difficult project but are exhausted from the fight. Muster your final reserves of strength.", family: "You are guarding your boundaries against family pressure. You're tired of the conflict, but you have the resilience to hold your ground." },
                reversed: { general: "Indicates exhaustion, stubbornness, and feeling trapped. You are either too weary to continue the fight or are stubbornly refusing to compromise.", love: "You are putting up walls in your relationship out of past hurt. This defensiveness is preventing a resolution.", career: "You are feeling paranoid and defensive at work, which is isolating you. You are refusing to back down from a losing battle.", family: "Being overly defensive and stubborn in family matters. You're exhausted from the conflict but refuse to let your guard down, leading to a stalemate." },
                blunt: "You're battle-weary but still standing. This is the final push. Use your resilience and courage to see it through." } },
            { name: "Ten of Wands", svg: `<g><path d="M45 40L25 120m5-80L30 120m5-80L35 120m5-80L40 120m5-80L45 120m10-80L55 120m5-80L60 120m5-80L65 120m5-80L70 120m5-80L75 120" /></g>`, meanings: {
                upright: { general: "Symbolizes burden, responsibility, and being overloaded. You have taken on too much and are now struggling under the weight of it all.", love: "Your relationship has become a burden. You may be carrying all the emotional weight and responsibility for the partnership.", career: "You are overloaded and stressed out at work. You have taken on too many responsibilities, and it's leading to burnout.", family: "You are carrying the weight of family responsibilities on your own. It's leading to immense stress and burnout." },
                reversed: { general: "Represents letting go of burdens and seeking support. You are finally realizing you cannot do it all alone.", love: "You are sharing the emotional load in your relationship or letting go of a partnership that has become too much of a burden.", career: "You are delegating tasks, saying 'no' to more responsibilities, or even leaving a job that is causing you immense stress.", family: "You are learning to delegate family duties or are setting boundaries to protect your energy. You are releasing burdens that are not yours to carry." },
                blunt: "You've taken on too much. You're being crushed by the burden. Delegate, or drop some of it before it breaks you." } },
            { name: "Page of Wands", svg: `<g><path d="M50 60v80" /><circle cx="50" cy="40" r="15" /><path d="M40 80h20m-10 20h20m-30 20h20" /></g>`, meanings: {
                upright: { general: "Embodies enthusiasm, exploration, and fresh ideas. This Page is a free spirit, eager to embark on an adventure and explore new creative territory.", love: "A new sense of fun and adventure is entering your love life. If single, you may meet someone energetic and cheerful.", career: "A new, exciting idea or opportunity at work. This is a time to be creative, explore new paths, and bring a fearless energy to your projects.", family: "A youthful, enthusiastic energy is present. It could be a child, or a 'childlike' approach to trying new things as a family." },
                reversed: { general: "Signifies hasty, unfocused energy and a lack of ideas. The initial enthusiasm has turned into impatience or unreliability.", love: "A relationship or crush that is immature and unreliable. This person may be all talk and no action.", career: "You are lacking direction and motivation at work. You have ideas but fail to follow through.", family: "An immature or flaky family member may be causing problems. Plans may be made with enthusiasm but are not followed through." },
                blunt: "Embrace your fearless, adventurous energy and explore a new idea. If reversed, stop being flaky and actually focus on something." } },
            { name: "Knight of Wands", svg: `<g><path d="M70 70L30 90l10 20L70 70" /><path d="M50 30L60 70H30L20 50z" /><path d="M55 70V140M60 130l-5 10-5-10" /></g>`, meanings: {
                upright: { general: "Represents action, ambition, and passionate adventure. This Knight is energetic, confident, and charges forward to achieve his goals.", love: "A passionate and adventurous suitor may enter your life. In a relationship, it is a time of high energy and shared adventures.", career: "A time for ambitious action. You may be changing jobs, launching a new business, or taking on a major project with immense energy.", family: "A time of great activity and energy for the family. Could indicate a family trip, a move, or a family member who is always on the go." },
                reversed: { general: "Warns of reckless, impulsive, and scattered energy. The Knight's passion has become unfocused, leading to haste, frustration, and burnout.", love: "A partner who is impulsive and fears commitment. They may be passionate one moment and gone the next.", career: "Making impulsive career decisions without thinking them through. You may be launching a business without a solid plan.", family: "A family member is acting impulsively or recklessly, creating chaos and instability for everyone." },
                blunt: "Time for ambitious, passionate action. But channel your energy. Reckless impulsiveness will lead to failure." } },
            { name: "Queen of Wands", svg: `<g><rect x="35" y="40" width="30" height="100" /><path d="M50 20 L40 40 h20z" /><path d="M30 60 l-10 10 M30 80 l-10 10 M70 60 l10 10 M70 80 l10 10" /></g>`, meanings: {
                upright: { general: "Embodies confidence, charisma, and independence. The Queen of Wands is a social butterfly, full of energy, passion, and determination.", love: "You are bringing a confident, passionate, and independent energy to your love life. You know what you want and are not afraid to go after it.", career: "You are highly productive and influential at work. Your charisma and determination make you a natural leader.", family: "A confident and charismatic matriarch or central female figure who keeps the family vibrant and socially active." },
                reversed: { general: "Signifies a lack of confidence and self-respect. Insecurity may be causing you to be jealous, introverted, or even manipulative.", love: "Insecurity and low self-esteem are negatively affecting your relationship. This can manifest as jealousy or neediness.", career: "You are paying too much attention to others' opinions at work, and it's killing your confidence. This can also indicate manipulative behavior.", family: "An insecure or jealous female family member is causing drama. Her lack of self-respect is creating problems for the whole family." },
                blunt: "Own your confidence and charisma. Be the passionate, independent, and influential person you are. If reversed, your insecurities are showing; find your self-respect." } },
            { name: "King of Wands", svg: `<g><rect x="25" y="40" width="50" height="100" /><path d="M50 20 L35 40 h30z" /><path d="M25 60 l-5 5 M25 80 l-5 5 M25 100 l-5 5 M75 60 l5 5 M75 80 l5 5 M75 100 l5 5" /></g>`, meanings: {
                upright: { general: "Represents visionary leadership, ambition, and taking control. The King of Wands is a natural-born leader who inspires others with his confidence and determination.", love: "A passionate and committed relationship. The King of Wands as a partner is a devoted, charismatic leader who protects and inspires.", career: "You are in a powerful leadership position or are being called to take one. It's time to act on your ambitious vision and inspire your team.", family: "A visionary and inspiring patriarchal figure who leads the family with confidence and a clear direction for the future." },
                reversed: { general: "Warns of impulsiveness, ruthlessness, and arrogance. This King can be a tyrant, using his power to control others with unrealistic expectations.", love: "A partner who is controlling, aggressive, or has a fiery temper. This is not leadership; it's tyranny.", career: "A domineering, ruthless boss or an impulsive, ill-conceived leadership style.", family: "A controlling or arrogant patriarch is creating a tense family environment. His temper or unrealistic expectations are causing conflict." },
                blunt: "You have the vision and authority of a king. Lead with passion. If reversed, stop being a tyrant." } }
        ],
        cups: [
            // ... [All cup meanings remain the same] ...
            { name: "Ace of Cups", svg: `<path d="M 30 50 a 20 30 0 0 1 40 0 v -10 h-40z M 50 50 v 80 M 40 130 h 20" />`, meanings: {
                upright: { general: "Represents a new emotional beginning, an outpouring of love, and creative expression. Your heart is open and ready to give and receive love.", love: "The start of a new relationship or a renewal of deep love in an existing one. It can also indicate proposals or pregnancy.", career: "A new job or project that you feel truly passionate about. Your creativity is flowing, and you feel emotionally fulfilled by your work.", family: "A new wave of love and compassion is flowing through the family. This could signify forgiveness, a birth, or a deeply heartfelt reunion." },
                reversed: { general: "Signifies a blockage of emotions. You may be repressing your feelings or feeling sad and spiritually depleted.", love: "Your emotions are blocked, preventing a relationship from forming or deepening. This can point to unrequited love or the painful end of a romance.", career: "You are feeling emotionally unfulfilled or drained by your work. Your creative ideas are blocked.", family: "Emotions are being repressed within the family, leading to sadness and a feeling of disconnect. It's time to encourage open communication of feelings." },
                blunt: "A new wave of emotion, love, or creativity is here. Open your heart to it. If it's blocked, you need to find out why." } },
            { name: "Two of Cups", svg: `<path d="M 25 70 a 15 20 0 0 1 20 0 M 75 70 a 15 20 0 0 0 -20 0 M 45 70 l 10 0 M 50 20 L 40 40 h 20z" />`, meanings: {
                upright: { general: "Represents a deep connection, partnership, and mutual attraction. A union built on harmony, reciprocity, and shared feelings.", love: "This is a soulmate card. It represents a beautiful, balanced, and mutually respectful partnership.", career: "A strong and harmonious business partnership. Your relationships with colleagues are positive and collaborative.", family: "A harmonious bond between two family members. This connection is built on mutual love, respect, and understanding." },
                reversed: { general: "Indicates disharmony, disconnection, and imbalance in a partnership. Trust may be broken, and the flow of emotion is blocked.", love: "Conflict and disharmony are present. The relationship is imbalanced, with one person giving more than the other.", career: "A business partnership is failing or a source of conflict.", family: "A conflict or misunderstanding has broken the harmony between family members. The connection is strained and unequal." },
                blunt: "This is about a partnership built on mutual attraction and harmony. If it's imbalanced, it's failing. It requires equal give and take." } },
            { name: "Three of Cups", svg: `<path d="M 20 80 a 10 15 0 0 1 20 0 M 80 80 a 10 15 0 0 0 -20 0 M 50 30 a 10 15 0 0 1 0 30 M 50 30 a 10 15 0 0 0 0 30" />`, meanings: {
                upright: { general: "A card of celebration, friendship, and community. It signifies joyful gatherings, collaborations, and reunions.", love: "A celebration in your relationship, like an engagement party or wedding. Enjoying time with your partner and a wider circle of friends.", career: "A successful collaboration at work. This is a great time for teamwork and celebrating a group achievement.", family: "This card points to a happy family celebration or party. It's about finding joy with your family and close friends." },
                reversed: { general: "Warns of overindulgence, gossip, and isolation. A celebration may be canceled, or it turns sour.", love: "Gossip or third-party interference is causing problems in your relationship.", career: "A work environment filled with gossip and backstabbing. A collaboration may fail due to a lack of genuine teamwork.", family: "Gossip or overindulgence could be ruining a family celebration. In some cases, it can warn of a third party creating conflict within the family." },
                blunt: "It's time to celebrate with your community and friends. If reversed, watch out for gossip and overindulgence ruining the good times." } },
            { name: "Four of Cups", svg: `<g><path d="M15 100a10 15 0 0 1 20 0v-10h-20zM40 100a10 15 0 0 1 20 0v-10h-20zM65 100a10 15 0 0 1 20 0v-10h-20z"/><path d="M60 40a10 15 0 0 1 20 0v-10h-20z"/></g>`, meanings: {
                upright: { general: "Symbolizes apathy, contemplation, and missed opportunities. You fail to see a new opportunity being offered because you are absorbed in discontent.", love: "You are feeling apathetic or bored with your love life. If single, you may be turning down potential connections.", career: "Boredom and dissatisfaction in your job. You are feeling stagnant and unmotivated.", family: "Feeling emotionally withdrawn or apathetic towards family life. You may be taking your family for granted, failing to see the love being offered." },
                reversed: { general: "Represents the end of stagnation and a newfound sense of self-awareness. You are moving out of your apathy, ready to seize opportunities.", love: "You are emerging from a period of romantic apathy. You are now open to new connections or are ready to see your partnership with fresh eyes.", career: "A newfound enthusiasm for your career. You are breaking out of your professional rut, ready to take on new challenges.", family: "You are starting to appreciate your family again after a period of withdrawal. You are ready to re-engage with them with a new perspective." },
                blunt: "You're so absorbed in your discontent that you're missing a real opportunity. Snap out of your apathy and see what's in front of you." } },
            { name: "Five of Cups", svg: `<g><path d="M15 120 l -5-5v-10h20v10l-5 5 M35 120 l -5-5v-10h20v10l-5 5 M55 120 l -5-5v-10h20v10l-5 5" /><path d="M45 50a10 15 0 0 1 20 0v-10h-20z M65 50a10 15 0 0 1 20 0v-10h-20z" /></g>`, meanings: {
                upright: { general: "A card of loss, grief, and disappointment. You are focused on what has been lost and are failing to see what remains.", love: "This card often appears after a breakup or a major disappointment in a relationship. You are dwelling on the pain and loss.", career: "A setback at work, such as a job loss or a failed project. You are consumed by regret and disappointment.", family: "Grief and loss are affecting the family. Dwelling on a past family sorrow is preventing healing and moving forward." },
                reversed: { general: "Represents acceptance, moving on, and healing. You are finally turning around to see what remains.", love: "You are moving on from past heartbreak. By forgiving yourself and others, you are healing old wounds.", career: "You are recovering from a professional setback. A job loss may lead to a better opportunity.", family: "The family is beginning to heal and accept a past loss. It's time to focus on the relationships that remain and find forgiveness." },
                blunt: "Stop crying over spilled milk. Grieve your loss, but then turn around and see what you still have." } },
            { name: "Six of Cups", svg: `<g><path d="M30 40a10 15 0 0 1 20 0v-10h-20z M70 80a10 15 0 0 1 20 0v-10h-20z M50 120 h20" /><path d="M30 40V120H50" /><path d="M50 40v40" /><path d="M70 80V120H90" /></g>`, meanings: {
                upright: { general: "A card of nostalgia, childhood memories, and innocence. It often signifies a reunion with people from your past.", love: "Reconnecting with a past love or a relationship that feels comfortable and secure, like you've known each other forever.", career: "You may be returning to a past job or working on a project that evokes a sense of nostalgia.", family: "A strong connection to past family memories and childhood. It suggests reunions with family or a return to your childhood home." },
                reversed: { general: "Warns of being stuck in the past. You may be idealizing 'the good old days' and are unable to move on.", love: "You are clinging to a past relationship or are constantly comparing your current partner to a former one.", career: "Your career is stagnating because you are stuck in old ways of doing things.", family: "Unresolved childhood issues or being stuck in past family dynamics is preventing growth. It's time to face reality and move on from the past." },
                blunt: "Enjoy the nostalgia, but don't get stuck there. It's time to grow up and move on." } },
            { name: "Seven of Cups", svg: `<g><path d="M50 40q-5-5-10 0t10 10q5 5 10 0t-10-10 M40 80q-5-5-10 0t10 10q5 5 10 0t-10-10 M60 80q-5-5-10 0t10 10q5 5 10 0t-10-10 M30 120q-5-5-10 0t10 10q5 5 10 0t-10-10 M50 120q-5-5-10 0t10 10q5 5 10 0t-10-10 M70 120q-5-5-10 0t10 10q5 5 10 0t-10-10"/></g>`, meanings: {
                upright: { general: "Represents choices, options, and illusion. You are faced with many possibilities, but not all of them are real or valuable.", love: "You have multiple romantic options, or you are indulging in fantasies about an ideal partner. Be careful not to get so lost in choices.", career: "You have many potential career paths or project ideas. You need to ground them in reality and choose one to focus on.", family: "The family may be considering many different options or plans, but some are just wishful thinking. A dose of reality is needed." },
                reversed: { general: "Signifies clarity and a return to reality. You are cutting through the illusions and are finally ready to make a clear, focused choice.", love: "You are gaining clarity about what you truly want in a relationship. The illusions are falling away.", career: "You have finally chosen a career path or project to focus on. You have moved past the daydreaming phase.", family: "The family is finally making a clear choice after a period of confusion and fantasy. The path forward is becoming clear." },
                blunt: "You have too many choices, and most of them are illusions. Stop daydreaming and pick one real thing to focus on." } },
            { name: "Eight of Cups", svg: `<g><path d="M15 120h20v-10a10 10 0 10-20 0z m20 0h20v-10a10 10 0 10-20 0z m20 0h20v-10a10 10 0 10-20 0z m-40-20h20v-10a10 10 0 10-20 0z m20 0h20v-10a10 10 0 10-20 0z"/><path d="M60 40 l 20 -20 l 10 20"/></g>`, meanings: {
                upright: { general: "Represents walking away from a situation that is no longer emotionally fulfilling. It is a card of disillusionment but also of courage.", love: "Leaving a relationship that is emotionally empty for you. You are courageously choosing to seek a deeper connection.", career: "You are walking away from a dissatisfying job or career path. The stability it offered is no longer enough.", family: "Feeling the need to emotionally or physically distance yourself from the family to search for something more fulfilling for your soul." },
                reversed: { general: "Indicates a resistance to change and a fear of the unknown. You are clinging to an unfulfilling situation out of fear or complacency.", love: "You are staying in an unhappy relationship out of a fear of being alone.", career: "You are stuck in a dead-end job. The thought of leaving is too scary, so you stay.", family: "You feel trapped by family obligations and are afraid to walk away, even though you know the situation is emotionally draining." },
                blunt: "What you have is no longer emotionally fulfilling. It's time to walk away and seek something deeper. Staying is a dead end." } },
            { name: "Nine of Cups", svg: `<g><path d="M10 40 h 80"/><path d="M15 30v-10a5 10 0 1110 0v10 m10 0v-10a5 10 0 1110 0v10 m10 0v-10a5 10 0 1110 0v10 m10 0v-10a5 10 0 1110 0v10 m10 0v-10a5 10 0 1110 0v10 "/><rect x="40" y="60" width="20" height="80"/></g>`, meanings: {
                upright: { general: "Often called the 'wish card,' it represents contentment, satisfaction, and wishes fulfilled. It is a card of emotional abundance.", love: "You are feeling deep contentment and satisfaction in your love life. Your relationship wishes are coming true.", career: "Achieving your career goals and enjoying the satisfaction that comes with it. This can also indicate financial comfort.", family: "A card of immense contentment and emotional fulfillment within the family. Everyone is happy, and their wishes have been granted." },
                reversed: { general: "Warns of unfulfilled desires and dissatisfaction. What you thought you wanted has not brought you the happiness you expected.", love: "Your relationship may look good on the surface, but it lacks deeper emotional connection. You have what you wished for, but are not satisfied.", career: "A dream job or achievement has turned out to be a disappointment. Material success does not equal happiness.", family: "The family may look perfect from the outside, but there is a deep sense of dissatisfaction and unfulfillment within." },
                blunt: "You're getting what you wished for. This is the 'wish card,' so enjoy it. If reversed, your desire was superficial and won't bring real happiness." } },
            { name: "Ten of Cups", svg: `<g><path d="M10 80 A 40 40 0 0 1 90 80"/><path d="M20 70 a5 10 0 1110 0v10 m10 0 a5 10 0 1110 0v10 m10 0 a5 10 0 1110 0v10 m10 0 a5 10 0 1110 0v10"/></g>`, meanings: {
                upright: { general: "The ultimate card of emotional fulfillment, representing lasting happiness, family harmony, and divine love.", love: "This is the picture-perfect image of a happy family and a fulfilling long-term relationship. Deep emotional connection, harmony, and lasting joy.", career: "A harmonious work-life balance. Your career is supporting a happy home life, not taking away from it.", family: "This is the 'happily ever after' card for family life. It represents lasting joy, emotional connection, and total harmony in the home." },
                reversed: { general: "Indicates a broken or unhappy family life. There is conflict, disharmony, and separation.", love: "Conflict and disharmony are tearing your relationship or family apart. Your vision of a happy home is not matching reality.", career: "Your work life is creating conflict at home, or a hostile work environment is making you miserable.", family: "A breakdown in family harmony. The vision of a happy home is shattered, and there is conflict and disconnection." },
                blunt: "This is the 'happily ever after' card of domestic bliss. Cherish it. If reversed, your vision of family is broken; find out why." } },
            { name: "Page of Cups", svg: `<g><path d="M40 70 a 10 20 0 0 1 20 0 v 70 h -20 z"/><path d="M50 40 a 5 5 0 1 0 0.1 0 Z"/></g>`, meanings: {
                upright: { general: "Brings a message of creative opportunity, intuition, and new feelings. A gentle, sensitive dreamer, urging you to listen to your heart.", love: "A romantic proposal, a declaration of feelings, or a new, gentle crush may be on the horizon.", career: "An opportunity to use your creativity and intuition at work. A new project may arise that you feel genuinely connected to.", family: "A message of love from a family member. Can represent a sensitive and imaginative child or a time of emotional openness." },
                reversed: { general: "Warns of emotional immaturity, creative blocks, and vulnerability. You may be insecure, easily hurt, or prone to daydreaming.", love: "Emotional immaturity is causing problems. This could be you or a partner acting childishly or being overly sensitive.", career: "Your creative ideas are blocked, or you are indulging in wishful thinking about your career without putting in the work.", family: "An emotionally immature family member is causing issues. It's a time of hurt feelings and emotional instability." },
                blunt: "Be open to new feelings and creative messages. Your intuition is speaking to you. If you're being immature, you're blocking the good news." } },
            { name: "Knight of Cups", svg: `<g><path d="M40 90 a10 20 0 0120 0 m-10 0v-20" /><path d="M20 130 q 30-20 60 0" /><path d="M40 130 q 10-10 20 0" /></g>`, meanings: {
                upright: { general: "Represents romance, charm, and following the heart. This Knight is an idealist, a poet, and a messenger of love.", love: "The arrival of a charming, romantic suitor. This is the classic knight in shining armor.", career: "Pursuing a career path that you are truly passionate about, especially in the arts. You are acting from a place of inspiration.", family: "A charming family member who is a dreamer or idealist. He brings messages of love and creative opportunities." },
                reversed: { general: "Warns of emotional immaturity, moodiness, and unrealistic expectations. This Knight can be all style and no substance.", love: "A suitor who is emotionally immature, moody, or insincere. They may be in love with the idea of love, not with you.", career: "A creative project may fail due to a lack of practical grounding. You may be disappointed when a 'dream job' doesn't live up to your fantasies.", family: "A moody and unrealistic family member is creating drama. Their emotional immaturity is causing problems for others." },
                blunt: "Follow your heart and chase that romantic ideal. But if reversed, be warned that charm can quickly turn into unrealistic, moody nonsense." } },
            { name: "Queen of Cups", svg: `<g><path d="M35 100 a15 30 0 0130 0v40h-30z" /><path d="M50 20 L40 40 h20z" /><path d="M20 120 h60"/></g>`, meanings: {
                upright: { general: "Embodies compassion, intuition, and emotional security. The Queen of Cups is a kind, supportive, and empathetic figure.", love: "You or your partner are embodying a nurturing, compassionate, and emotionally secure energy. A loving and loyal relationship.", career: "Bring compassion and intuition to your work. This is a good time to mentor others or to work in a helping profession.", family: "A compassionate, nurturing matriarchal figure. She is the emotional bedrock of the family, providing empathy and security." },
                reversed: { general: "Warns of emotional insecurity, neediness, and being overly sensitive. The Queen's compassion has turned inward to self-pity or outward as smothering.", love: "Insecurity and neediness are creating problems. You or your partner may be emotionally immature, manipulative, or smothering.", career: "Your emotions are overwhelming you at work. You may be taking things too personally.", family: "A family member is being emotionally manipulative or needy. This insecurity can create a draining and unstable home environment." },
                blunt: "Lead with compassion and intuition; your emotional security is your strength. If reversed, your neediness and insecurity are not helping." } },
            { name: "King of Cups", svg: `<g><path d="M30 110 a20 25 0 0140 0v30h-40z" /><path d="M50 20 L35 40 h30z" /><path d="M20 140 h60"/><path d="M25 80 q 25-20 50 0 M30 90 q 20-15 40 0"/></g>`, meanings: {
                upright: { general: "Represents emotional maturity, balance, and control. He is a master of his own feelings, compassionate and diplomatic.", love: "An emotionally mature and supportive partner. A deep, stable, and balanced relationship where both partners feel secure.", career: "Using your emotional intelligence to succeed. You can navigate difficult workplace dynamics with diplomacy and calm.", family: "A mature, emotionally balanced patriarchal figure. He offers calm guidance and diplomacy, keeping the family stable." },
                reversed: { general: "Warns of emotional instability, manipulation, and moodiness. This King can be a cold, controlling figure who uses emotional tactics to get what he wants.", love: "An emotionally manipulative or unstable partner. There may be mood swings, gaslighting, or passive-aggressive behavior.", career: "A boss or colleague who is irrational or uses emotional manipulation to control the workplace.", family: "An emotionally manipulative or unstable patriarch is creating conflict. His mood swings or controlling behavior are damaging family relationships." },
                blunt: "Master your emotions. True power comes from emotional balance and control, not manipulation." } }
        ],
        swords: [
            // ... [All sword meanings remain the same] ...
            { name: "Ace of Swords", svg: `<path d="M 50 140 V 20 M 35 130 H 65 M 40 20 a 10 10 0 1 1 20 0 a 10 10 0 1 1 -20 0" />`, meanings: {
                upright: { general: "A breakthrough of truth and mental clarity. This card cuts through confusion to reveal a new idea, a new vision, or a simple, powerful truth.", love: "A moment of absolute clarity in your relationship. It’s time for an honest conversation that will clear the air.", career: "A brilliant new idea or strategy. This card signals success in matters requiring sharp intellect and focused vision.", family: "A moment of truth within the family that cuts through long-held confusion or denial. It's time for an honest family conversation." },
                reversed: { general: "Signifies clouded judgment, confusion, and poor communication. An idea may be flawed, or you lack the mental clarity to make a good decision.", love: "Miscommunication and misunderstanding are causing conflict. Your judgment about the relationship is clouded.", career: "A lack of focus or a flawed idea is leading to professional frustration. Your communication may be unclear.", family: "Miscommunication and misunderstanding are creating conflict in the family. Important information is being withheld or is confused." },
                blunt: "This is a breakthrough of pure, cutting truth. Use this moment of mental clarity to win." } },
            { name: "Two of Swords", svg: `<g><path d="M 20 20 L 80 140 M 80 20 L 20 140" /><path d="M50 80 a 20 20 0 0 1 0 0.1"/></g>`, meanings: {
                upright: { general: "Represents a stalemate, indecision, and being caught between two difficult choices. You are deliberately blocking out information to avoid a painful decision.", love: "You are at an impasse in your relationship and are avoiding a difficult conversation or choice to keep the peace.", career: "You are stuck between two career options or are in a stalemate with a colleague or project. You are avoiding making a decision.", family: "A stalemate in the family. A difficult choice is being avoided, creating a tense but superficial peace. The issue needs to be faced." },
                reversed: { general: "The blindfold is coming off. You can no longer avoid the decision, and this is causing emotional or mental upheaval.", love: "The truth can no longer be ignored, leading to a potential crisis in the relationship. The decision you've been avoiding is now forced upon you.", career: "An external event has broken the stalemate at work, forcing your hand. The indecision is over, but now you must deal with the fallout.", family: "The family stalemate is breaking, causing emotional upheaval. A choice you've been putting off is now being forced, leading to turmoil." },
                blunt: "You're in a stalemate because you're willfully avoiding a choice. Stop blindfolding yourself to the truth and decide." } },
            { name: "Three of Swords", svg: `<path d="M 20 80 L 80 80 L 50 120 Z M 50 20 V 90 M 40 80 L 20 50 M 60 80 L 80 50" />`, meanings: {
                upright: { general: "A card of heartbreak, sorrow, and painful truth. The swords of truth have pierced the heart of illusion.", love: "This is the classic card of heartbreak, betrayal, or a painful breakup. Hurtful words have been spoken.", career: "Receiving painful news at work, such as being fired, a project being cancelled, or a harsh criticism.", family: "A painful family truth has been revealed, causing sorrow and heartbreak for all involved. Hurtful words may have been spoken." },
                reversed: { general: "Represents the slow process of healing and forgiveness after a period of pain. You are releasing your grief and moving on.", love: "You are recovering from a heartbreak, forgiving, and moving on. Be careful not to hold onto bitterness.", career: "You are recovering from a professional setback. It's time to release the negativity and focus on the future.", family: "The family is beginning the slow process of healing after a painful event or revelation. It's time to release bitterness and forgive." },
                blunt: "This is pure heartbreak and sorrow. Experience the pain so you can move on. Replaying it in your head only makes it worse." } },
            { name: "Four of Swords", svg: `<g><rect x="15" y="80" width="70" height="20" /><path d="M50 30 v80 M50 30L30 50 M50 30L70 50" /><path d="M25 70h50m-50 40h50" /></g>`, meanings: {
                upright: { general: "A card of rest, recuperation, and contemplation. It is a necessary pause after a period of conflict or stress.", love: "A relationship needs a 'time out.' This is not a breakup, but a necessary pause for both partners to rest and regain perspective.", career: "Take a break from work. This can be a vacation, a sabbatical, or simply a mental withdrawal from work stress.", family: "The family needs a period of peace and quiet. After a period of conflict or stress, it is time for the family unit to rest and recuperate." },
                reversed: { general: "Warns of exhaustion, burnout, and a desperate need for rest that is being ignored. It can also signify the end of a period of rest.", love: "You are returning to your relationship after a period of distance, hopefully refreshed. Or, you are refusing to give the relationship the peaceful break it needs.", career: "Either you are heading for burnout by refusing to take a break, or your period of rest is over and it's time to get back to work.", family: "The family is approaching burnout due to constant stress. The necessary period of rest is being ignored, leading to greater problems." },
                blunt: "You need to rest. Take a break from the challenges and recuperate. Pushing through will only lead to burnout." } },
            { name: "Five of Swords", svg: `<g><path d="M50 140V20 M40 130 h20" /><path d="M25 110 l25 -10 l-15 30"/><path d="M75 110 l-25 -10 l15 30"/></g>`, meanings: {
                upright: { general: "Represents a conflict won at a great cost. It is a hollow victory, where your ambition has come at the expense of others.", love: "You may have 'won' an argument with your partner, but you have damaged the relationship in the process. Scoring points is more important than harmony.", career: "You have succeeded at work, but perhaps through unethical means or at the expense of your colleagues' respect.", family: "Winning an argument with a family member has created a hostile and painful environment. It's a bitter victory." },
                reversed: { general: "Signifies a desire for reconciliation after a conflict. You realize the battle is not worth the cost and are ready to compromise.", love: "You are ready to end the conflict and seek reconciliation. It's time to admit that winning the argument is less important than saving the relationship.", career: "The conflict at work is coming to an end. You are ready to move on, compromise, or even apologize.", family: "There is a desire for peace and reconciliation within the family. It's time to apologize and accept that winning isn't worth the cost." },
                blunt: "You might win this conflict, but it will be a hollow victory. Pick your battles wisely. Sometimes reconciliation is the greater strength." } },
            { name: "Six of Swords", svg: `<g><path d="M20 120 q 30-10 60 0"/><path d="M50 40V110 m-5 0h10"/><path d="M40 50V110 m-5 0h10"/><path d="M30 60V110 m-5 0h10"/><path d="M60 50V110 m-5 0h10"/><path d="M70 60V110 m-5 0h10"/></g>`, meanings: {
                upright: { general: "Represents a transition, often moving away from a difficult situation towards a calmer, more hopeful future.", love: "You are moving on from a difficult relationship period or leaving a painful partnership behind. You are heading towards emotional stability.", career: "Leaving a stressful job or difficult work situation behind. You are transitioning to a more supportive and peaceful professional environment.", family: "Moving on from a difficult family situation. This could be a literal move or an emotional transition to a more peaceful dynamic." },
                reversed: { general: "Indicates feeling trapped and unable to move on. Progress is slow, and you may be resisting a necessary change.", love: "You feel trapped in a difficult relationship dynamic and cannot see a way out. The transition to peace feels blocked.", career: "You feel trapped in a stressful job, and any attempts to leave are met with obstacles.", family: "Feeling stuck in a negative family dynamic with no escape. Unfinished business from the past is holding you here." },
                blunt: "It's time to move on from a difficult situation. This is a transition to calmer waters. Release the baggage and find peace." } },
            { name: "Seven of Swords", svg: `<g><path d="M30 40 l -10 100 m5 -90 l-10 100 m5-90 l-10 100 m5-90 l-10 100 m5-90 l-10 100" /><path d="M80 70l-15-5 l5-15 l20 5z" /></g>`, meanings: {
                upright: { general: "A card of deception, trickery, and getting away with something. Someone is acting alone and not being fully transparent.", love: "There is deception or betrayal in the relationship. One partner is being dishonest or is hiding something.", career: "Shady dealings at work. A colleague may be stealing your ideas or sabotaging you.", family: "A family member is being deceptive or sneaky. There are secrets being kept which may harm the family." },
                reversed: { general: "Represents a confession and the truth being revealed. The deception is not working, and a guilty conscience is leading to a desire to come clean.", love: "Lies and deception in the relationship are being exposed. It's a time for confessions and coming clean.", career: "A colleague's deceptive tactics are being revealed, or you have decided to confess to a misdeed at work.", family: "The truth about a family secret is being revealed. It's time for confessions and accountability within the family." },
                blunt: "There is deception and trickery afoot. Whether it's you or someone else, it's a weak strategy. Come clean and take responsibility." } },
            { name: "Eight of Swords", svg: `<g><circle cx="50" cy="80" r="10"/><path d="M50 70V90"/><path d="M20 20v120m10-120v120m10-120v120m10-120v120m20-120v120m10-120v120m10-120v120m10-120v120"/></g>`, meanings: {
                upright: { general: "Symbolizes a feeling of being trapped, restricted, and powerless. However, this is a self-imposed prison of negative thoughts and a victim mentality.", love: "You feel trapped in a relationship and believe there is no way out. Your own negative thoughts and fears are your true prison.", career: "You feel trapped and restricted in your job, believing your options are limited. This victim mentality is preventing you from seeing opportunities.", family: "You feel trapped by your family situation, but your own limiting beliefs are the true cause. A change in perspective is needed to feel free." },
                reversed: { general: "Represents releasing self-limiting beliefs and finding freedom. You are finally seeing that you were your own captor.", love: "You are freeing yourself from a restrictive relationship or from the negative thought patterns that made you feel trapped within it.", career: "You are finding solutions to the career challenges that made you feel trapped. By changing your perspective, you are taking control.", family: "You are breaking free from the victim mentality that kept you stuck in family drama. You are seeing your own power in the situation." },
                blunt: "You feel trapped, but it's a prison of your own mind. Your limitations are self-imposed. Free yourself by changing your thoughts." } },
            { name: "Nine of Swords", svg: `<g><rect x="15" y="100" width="70" height="20" /><path d="M20 40v50m10-50v50m10-50v50m10-50v50m10-50v50m10-50v50m10-50v50" /><path d="M50 120v20"/></g>`, meanings: {
                upright: { general: "The 'nightmare' card. It represents deep anxiety, worry, fear, and depression. These are mental anguish and negative thoughts.", love: "Your relationship is a source of deep anxiety and worry. Guilt, fear, or suspicion may be tormenting you.", career: "Extreme stress and anxiety related to your job. You may be worried about your performance or job security.", family: "Deep anxiety and worry related to a family situation. It is causing sleepless nights and despair." },
                reversed: { general: "Signifies either an escalation of inner turmoil into a full-blown crisis or the beginning of recovery. You are either facing your fears or letting go.", love: "The anxieties in your relationship are either reaching a breaking point or you are finally beginning to release them.", career: "The stress at work is either becoming unbearable, leading to a breakdown, or you are finding ways to cope.", family: "Family anxieties are either reaching a crisis point or are finally being addressed and released. The situation is coming to a head." },
                blunt: "You are at a breaking point, consumed by anxiety and fear born from your own thoughts. Face your deep-seated fears and seek help." } },
            { name: "Ten of Swords", svg: `<g><rect x="15" y="100" width="70" height="20" /><path d="M20 100V40 m10 60V40 m10 60V40 m10 60V40 m10 60V40 m10 60V40 m10 60V40" /><path d="M50 120v20" /></g>`, meanings: {
                upright: { general: "Represents a painful and definitive ending. This is rock bottom, betrayal, and total ruin. The only way is up.", love: "A painful, dramatic, and final end to a relationship, often involving deep betrayal. There is no hope for reconciliation.", career: "A devastating end to a job or project, possibly through being fired or betrayed by colleagues.", family: "The painful end of a family relationship or dynamic. This is a dramatic and final 'rock bottom' moment for the family." },
                reversed: { general: "Represents recovery and regeneration after a crisis. You are slowly pulling the swords out, learning from the painful experience.", love: "You are beginning to heal from a terrible breakup or betrayal. It's a slow process, but you are finding the strength to move on.", career: "After a major career blow, you are slowly recovering and rebuilding. You are learning from your failure.", family: "The family is a survivor of a major crisis. The recovery is slow, but the worst is over. It's time to heal the wounds." },
                blunt: "You've hit rock bottom. It's over. Stop fighting it. The only thing left to do is accept the loss and start getting back up." } },
            { name: "Page of Swords", svg: `<g><circle cx="50" cy="40" r="15" /><path d="M50 55v85 M35 130h30" /></g>`, meanings: {
                upright: { general: "Embodies a restless, curious energy. This Page is full of new ideas, thirsty for knowledge, and eager to communicate.", love: "A time for honest and witty communication in your relationship. However, this energy can also be defensive and argumentative.", career: "You are exploring new ideas and plans at work with a sharp mind. It's a great time for research and learning a new skill.", family: "Curious, probing conversations within the family. Can represent an inquisitive child or a time of asking many questions." },
                reversed: { general: "Warns of being all talk and no action. You may be making promises you can't keep or acting hastily without thinking.", love: "Communication in your relationship is defensive or leads to petty arguments. This is not a time for productive conversation.", career: "You have ideas but are failing to act on them. Haphazard action is leading to disappointments.", family: "Petty arguments and gossipy, unproductive conversations. A family member might be all talk and no action." },
                blunt: "You're full of curious energy and new ideas. Seek the truth with vigilance, but don't just talk. Haphazard action leads to disappointment." } },
            { name: "Knight of Swords", svg: `<g><path d="M20 80h60l-10-20h-40z"/><path d="M50 20v60M40 70h20"/><path d="M40 100l20 30-20-15-20 15z" /></g>`, meanings: {
                upright: { general: "Represents ambitious, fast-thinking, and assertive action. This Knight is direct, focused, and impatient.", love: "Things are moving very quickly in your love life. This energy can be exciting, but also so direct that it lacks tenderness.", career: "A time of great ambition and drive at work. You are charging forward to achieve your goals with ruthless efficiency.", family: "A family member is charging ahead with a plan, perhaps without consulting others. This brings fast changes, for better or worse." },
                reversed: { general: "Warns of ruthless, aggressive, and impulsive behavior. The Knight's focus has turned into tactless and forceful action.", love: "A partner who is verbally aggressive, controlling, or bullying. There are intense arguments.", career: "A ruthless, cut-throat work environment. You or a colleague may be acting like a bully to get ahead.", family: "Aggressive arguments and tactless communication are creating conflict. A family member is acting impulsively and creating chaos." },
                blunt: "Charge forward with ambitious, fast-thinking action. Be assertive. If reversed, stop being a ruthless, tactless bully." } },
            { name: "Queen of Swords", svg: `<g><rect x="35" y="40" width="30" height="100" /><path d="M50 20 L40 40 h20z" /><path d="M35 100V60l-20 20 m55-20V60l20 20"/></g>`, meanings: {
                upright: { general: "Embodies clear-minded independence, honesty, and sharp perception. She uses her intellect to cut through illusion.", love: "An independent and intelligent partner. The relationship values honest communication and personal space.", career: "You are seen as a wise, perceptive, and professional figure at work. You offer clear, constructive criticism.", family: "A highly intelligent, no-nonsense female family member. She values truth and honesty, even if it's uncomfortable." },
                reversed: { general: "Warns of a bitter, malicious, and manipulative energy. The Queen's sharp mind is now used to hurt others with cruel words and gossip.", love: "A partner who is bitter, spiteful, or manipulative. Words are used as weapons.", career: "A pessimistic or overly critical person at work is creating a toxic environment.", family: "A cold, bitter female family member who uses words as weapons. She can be cruel and unforgiving." },
                blunt: "Use your clear-minded independence to communicate honestly and set firm boundaries. If reversed, stop using your words to hurt people." } },
            { name: "King of Swords", svg: `<g><rect x="25" y="40" width="50" height="100" /><path d="M50 20 L35 40 h30z" /><path d="M25 60 l-15 15 M25 90 l-15 15 M75 60 l15 15 M75 90 l15 15" /></g>`, meanings: {
                upright: { general: "Represents intellectual authority, truth, and ethical judgment. The King of Swords is a master of logic and reason.", love: "A relationship based on intellectual connection and clear communication. Your partner may be highly intelligent and value honesty.", career: "You are an authority in your field. This card represents a leader who is stern but fair, valuing truth and structure.", family: "An authoritative, logical patriarch or family head. He rules with fairness and intellectual clarity. A good source for objective advice." },
                reversed: { general: "Warns of a misuse of power, manipulation, and irrationality. This King can be a cold, ruthless dictator who uses his intelligence to control.", love: "A partner who is cold, controlling, or verbally abusive. They may use their intelligence to manipulate and win arguments.", career: "A tyrannical, power-hungry boss or a colleague who uses dishonest tactics.", family: "A controlling and manipulative patriarchal figure. His judgment is clouded by ego, and he uses his intellect to bully and control the family." },
                blunt: "You are the intellectual authority here. Use your logic to make fair, ethical, and decisive judgments. Don't be a tyrant." } }
        ],
        pentacles: [
            // ... [All pentacle meanings remain the same] ...
            { name: "Ace of Pentacles", svg: `<g><path d="M30 80 a 20 20 0 1 0 40 0 a 20 20 0 1 0 -40 0" /><path d="M40 40h20v20h-20z"/><path d="M45 40V20m10 20V20m-5 120V60" /></g>`, meanings: {
                upright: { general: "A new, tangible opportunity for prosperity and security. The seed of manifestation in the material world.", love: "The start of a stable, grounded, and secure relationship. A connection that has potential for long-term growth.", career: "An excellent sign for a new job, a raise, or a new investment opportunity. This is a chance to build something of lasting value.", family: "An opportunity for greater stability and security for the family. Could be a new home, financial windfall, or a chance to build a legacy." },
                reversed: { general: "A missed opportunity or poor financial planning. A new venture has been delayed or has failed.", love: "A potential relationship has failed to get off the ground due to practical insecurities. Financial stress may be preventing a stable partnership.", career: "A missed job opportunity, a bad investment, or a project that is failing due to poor planning.", family: "A missed opportunity for family security. Poor financial planning or a risky venture has destabilized the family's foundation." },
                blunt: "A tangible new opportunity for prosperity is here. Don't miss this chance through poor planning or greed." } },
            { name: "Two of Pentacles", svg: `<g><circle cx="35" cy="50" r="15" /><circle cx="65" cy="110" r="15" /><path d="M25 50 c 20 40, 30 40, 50 60" /><path d="M75 110 c-20-40 -30-40 -50-60" /></g>`, meanings: {
                upright: { general: "Represents balancing resources, adapting to change, and juggling priorities. Flexibility and good time management are key.", love: "You are trying to balance your relationship with other areas of your life (like work). It requires careful juggling.", career: "You are juggling multiple projects, jobs, or financial responsibilities. This is a time of being adaptable and flexible.", family: "Juggling family responsibilities with other life demands (work, etc.). It's a busy time that requires flexibility and adaptability." },
                reversed: { general: "Indicates being overcommitted and disorganized. The juggling act is failing, and you are starting to drop the balls.", love: "Your inability to balance your life is causing stress in your relationship. You may be neglecting your partner for work.", career: "You have taken on too much at work and are feeling overwhelmed and disorganized.", family: "Feeling overwhelmed by family and life demands. You've taken on too much, and the stress is leading to financial or domestic chaos." },
                blunt: "You are juggling too many things. You need to be adaptable and manage your time well. If reversed, you're dropping the balls; reprioritize." } },
            { name: "Three of Pentacles", svg: `<g><path d="M50 30L20 80h60z" /><circle cx="50" cy="55" r="10"/><circle cx="35" cy="95" r="10"/><circle cx="65" cy="95" r="10"/></g>`, meanings: {
                upright: { general: "Represents teamwork, collaboration, and craftsmanship. Your skills are being recognized, and by working with others, you can create something of high quality.", love: "You and your partner are working together as a team to build a strong foundation for your relationship.", career: "Successful teamwork is key. Your unique skills are a valuable contribution to a group project.", family: "A time for successful teamwork within the family. Working together on a project (like home renovations or planning an event) will bring success." },
                reversed: { general: "Indicates a lack of teamwork, poor motivation, and conflict. Egos may be clashing, or there is no cohesion in a group effort.", love: "A lack of teamwork in your relationship. You and your partner are not working together.", career: "Conflict and a lack of collaboration are ruining a project at work. You may feel your skills are not being valued.", family: "Family members are not working together. A lack of cooperation or clashing egos are causing a family project or the family unit itself to fail." },
                blunt: "Success will come through teamwork and collaboration. Your skills will be recognized if you work with others. Ego leads to mediocre work." } },
            { name: "Four of Pentacles", svg: `<g><circle cx="50" cy="30" r="15"/><circle cx="30" cy="120" r="15"/><circle cx="70" cy="120" r="15"/><circle cx="50" cy="80" r="15" /></g>`, meanings: {
                upright: { general: "Symbolizes conservation, security, and control. You are holding on tightly to your resources, but it warns of being possessive and guarded.", love: "You are being possessive or controlling in your relationship. Your fear of loss is causing you to hold on too tightly.", career: "You are in a stable but rigid financial situation. You may be holding onto a job for security, even if it's unfulfilling.", family: "There is a controlling or possessive energy in the family, likely over money or property. It creates stability but stifles growth and generosity." },
                reversed: { general: "Represents letting go, generosity, and openness. It can be liberating, but it can also warn of reckless spending and instability.", love: "You are letting go of your fear and possessiveness, allowing your relationship to become more open and trusting.", career: "You are either being generous with your resources or are being reckless. This can mean investing in a new venture or suffering a major financial loss.", family: "Releasing a tight-fisted control over family resources. This can be generous and liberating, but it also warns against financial recklessness affecting the family." },
                blunt: "You are holding on too tightly to your security, and it's blocking growth. If reversed, your reckless spending is creating instability." } },
            { name: "Five of Pentacles", svg: `<g><path d="M50 30L20 80h60z" /><circle cx="35" cy="120" r="10"/><circle cx="65" cy="120" r="10"/><circle cx="30" cy="90" r="10"/><circle cx="50" cy="90" r="10"/><circle cx="70" cy="90" r="10"/></g>`, meanings: {
                upright: { general: "A card of hardship, financial loss, and isolation. You are feeling left out in the cold, struggling with poverty, illness, or unemployment.", love: "You feel abandoned or rejected in love. This can signify a difficult breakup or a period of intense loneliness.", career: "A time of significant financial loss or unemployment. You feel insecure and isolated from your professional community.", family: "The family is experiencing financial hardship or a health crisis. There is a sense of being 'left out in the cold' and a lack of support." },
                reversed: { general: "Represents recovery from loss and the end of a difficult period. You are finding help and overcoming adversity.", love: "You are recovering from a painful breakup or a period of loneliness. You are beginning to feel emotionally secure again.", career: "Overcoming financial difficulties. You may find a new job after a period of unemployment or see your finances stabilize.", family: "The family is recovering from a period of hardship. Things are starting to improve, and support is being found, both within the family and from outside." },
                blunt: "You are experiencing financial hardship and isolation. Stop feeling abandoned and look for the help that is right there. Overcome your lack mindset." } },
            { name: "Six of Pentacles", svg: `<g><path d="M20 80h60M50 40v80" /><circle cx="30" cy="100" r="10"/><circle cx="70" cy="100" r="10"/><circle cx="50" cy="60" r="10"/></g>`, meanings: {
                upright: { general: "Represents generosity, charity, and the cycle of giving and receiving. A fair and balanced exchange of resources.", love: "A relationship with a balanced give-and-take. Both partners are generous and supportive of each other.", career: "Receiving financial help, such as a loan or bonus. It can also mean you are in a position to be generous with others.", family: "A time of balanced giving and receiving within the family. One member may be helping another financially, or there's a fair distribution of resources." },
                reversed: { general: "Warns of an imbalanced exchange. This can mean unpaid debts, financial exploitation, or 'gifts' with strings attached.", love: "One partner is giving far more than the other, creating a one-sided and unhealthy relationship.", career: "You are not being fairly compensated for your work, or you are taking on the workload of others without recognition.", family: "A one-sided financial situation in the family. One person may be abusing the generosity of others, or there are 'gifts' with strings attached." },
                blunt: "This is about the fair exchange of resources. Be generous, or be grateful. If the exchange is unequal, it's not generosity, it's a power play." } },
            { name: "Seven of Pentacles", svg: `<g><path d="M20 140v-80m-20-40H80" /><circle cx="30" cy="50" r="8"/><circle cx="50" cy="70" r="8"/><circle cx="70" cy="50" r="8"/><circle cx="30" cy="90" r="8"/><circle cx="50" cy="110" r="8"/><circle cx="70" cy="90" r="8"/><circle cx="50" cy="30" r="8"/></g>`, meanings: {
                upright: { general: "A card of patience, investment, and taking a long-term view. You are taking a moment to assess your progress.", love: "You are nurturing your relationship for long-term growth. A time to pause and assess the state of your partnership.", career: "Your long-term projects are showing promise. It's a good time to step back, evaluate your career progress, and adjust your long-term plan.", family: "Long-term family projects are showing promise. It is a time to be patient and assess where you are as a family, trusting in your shared future." },
                reversed: { general: "Warns of frustration and a lack of growth due to impatience or scattered efforts. You have invested your energy in something that is not yielding results.", love: "You are frustrated with the slow progress in your relationship. One or both partners may not be putting in the necessary effort.", career: "Your efforts at work are not yielding the desired results, leading to frustration.", family: "Frustration with the lack of progress on a family goal. Impatience is threatening to undo the hard work already invested." },
                blunt: "You've invested your effort; now have the patience to wait for results. Assess your progress, but don't get impatient." } },
            { name: "Eight of Pentacles", svg: `<g><rect x="45" y="20" width="10" height="120" /><circle cx="30" cy="40" r="8"/><circle cx="30" cy="60" r="8"/><circle cx="30" cy="80" r="8"/><circle cx="30" cy="100" r="8"/><circle cx="70" cy="40" r="8"/><circle cx="70" cy="60" r="8"/><circle cx="70" cy="80" r="8"/><circle cx="70" cy="100" r="8"/></g>`, meanings: {
                upright: { general: "Represents skill development, dedication, and craftsmanship. It signifies a commitment to hard work and high standards.", love: "You are putting in the hard work to make your relationship succeed. You are committed to learning about your partner and developing the skills to be a good partner.", career: "A time of dedication to your work. You may be starting a new job or committing to mastering a skill.", family: "Diligently working on improving family life. It’s about putting in the daily effort to build a happy home or improve relationships." },
                reversed: { general: "Warns of a lack of quality, laziness, and a poor reputation. You may be rushing through your work, leading to mediocrity.", love: "You or your partner are not putting in the effort to maintain the relationship. Laziness is causing the connection to deteriorate.", career: "You are producing sloppy, low-quality work due to a lack of motivation or focus.", family: "A lazy approach to family life is causing problems. Important duties are being neglected, or there's a lack of effort in maintaining relationships." },
                blunt: "Dedicate yourself to mastering your craft. Diligent, hard work is required. Laziness will only lead to a bad reputation." } },
            { name: "Nine of Pentacles", svg: `<g><circle cx="50" cy="30" r="8"/><circle cx="30" cy="50" r="8"/><circle cx="70" cy="50" r="8"/><circle cx="50" cy="70" r="8"/><circle cx="30" cy="90" r="8"/><circle cx="70" cy="90" r="8"/><circle cx="50" cy="110" r="8"/><circle cx="30" cy="130" r="8"/><circle cx="70" cy="130" r="8"/></g>`, meanings: {
                upright: { general: "Represents self-sufficiency, abundance, and independence. You have achieved material security and success through your own hard work.", love: "You are in a place of confidence and self-sufficiency, whether single or in a relationship. You do not 'need' a partner for security.", career: "You have achieved a level of success and financial independence in your career. You are respected for your accomplishments.", family: "A family that is financially independent and secure. It may also represent an independent family member who is successful on their own." },
                reversed: { general: "Warns of living beyond your means and material instability. You may be putting on a show of wealth, but it is a facade.", love: "A relationship may be based on financial gain rather than genuine love. You or your partner may be a 'gold-digger.'", career: "A setback at work due to a lack of effort or dishonesty. You may be involved in reckless business dealings.", family: "Financial instability within the family, or trying to 'keep up appearances' despite struggles. This can cause immense stress." },
                blunt: "You have achieved self-sufficient abundance through your own work. Enjoy the luxury you've earned. If reversed, your life is a reckless, superficial facade." } },
            { name: "Ten of Pentacles", svg: `<g><circle cx="50" cy="30" r="8"/><circle cx="30" cy="50" r="8"/><circle cx="70" cy="50" r="8"/><circle cx="50" cy="70" r="8"/><circle cx="30" cy="90" r="8"/><circle cx="70" cy="90" r="8"/><circle cx="50" cy="110" r="8"/><circle cx="20" cy="130" r="8"/><circle cx="50" cy="130" r="8"/><circle cx="80" cy="130" r="8"/></g>`, meanings: {
                upright: { general: "Represents lasting wealth, family, and legacy. This card signifies long-term stability, security, and a prosperous family life.", love: "A deeply committed, stable, and secure long-term partnership that feels like family.", career: "You have built a successful and stable career or business. This can represent a family business or financial security.", family: "The ultimate card of family stability, wealth, and inheritance. You have created a strong and lasting legacy." },
                reversed: { general: "Warns of family conflict, financial instability, or a disputed inheritance. The legacy you thought was secure is threatened.", love: "Conflict over finances is causing instability in your relationship. Clashing values on security.", career: "A family business may be in trouble, or your financial legacy is at risk.", family: "A major family dispute, likely over money or inheritance. The family's financial foundation is insecure and at risk." },
                blunt: "This is about long-term wealth, family, and legacy. You're building something that will last for generations. If reversed, that legacy is at risk." } },
            { name: "Page of Pentacles", svg: `<g><circle cx="50" cy="40" r="15"/><path d="M50 55 v85"/><circle cx="50" cy="80" r="10" /></g>`, meanings: {
                upright: { general: "Embodies the energy of a diligent student, eager to learn and manifest new opportunities. It is about applying yourself to achieve tangible results.", love: "A new relationship may be starting, but it will be a slow, steady, and practical one. A chance to build something grounded.", career: "An excellent card for a new job, internship, or starting a new course of study. Be a diligent student and apply yourself.", family: "A family member is embarking on a new course of study or practical venture. It's a time for learning and building for the future." },
                reversed: { general: "Signifies procrastination, laziness, and missed opportunities. You are not applying yourself to your goals.", love: "A relationship is stagnating due to a lack of effort. One or both partners are being lazy.", career: "You are procrastinating at work or have missed a valuable opportunity due to inaction.", family: "A younger family member may be struggling with laziness or a lack of direction, wasting opportunities." },
                blunt: "A new opportunity to manifest something real is here. Be a diligent student and apply yourself. Procrastination will mean this chance is wasted." } },
            { name: "Knight of Pentacles", svg: `<g><path d="M70 120 l-40 0 l10-30h20z" /><circle cx="50" cy="70" r="20" /><path d="M40 70 L20 60m40 20L80 90" /></g>`, meanings: {
                upright: { general: "Represents hard work, routine, and a slow, steady approach. This Knight is reliable, diligent, and patient.", love: "A partner who is incredibly reliable, loyal, and committed, though perhaps not the most exciting. This is about building a relationship through consistent effort.", career: "Success will come through a diligent, methodical routine. This is not a time for big risks, but for perfecting your process.", family: "Represents a hardworking, reliable, but perhaps stubborn family member. The family routine is stable and dependable." },
                reversed: { general: "Warns of stagnation, laziness, and being stuck in a boring, unfulfilling routine. You lack the motivation to work toward your goals.", love: "Your relationship has become a boring, mundane routine. The lack of effort has led to stagnation.", career: "You are stuck in a dead-end, boring job. You are unmotivated and just going through the motions.", family: "The family is stuck in a boring rut. There is a lack of motivation to change things, leading to stagnation and frustration." },
                blunt: "This is a marathon, not a sprint. Be reliable and diligent. If reversed, you're stuck in a lazy, boring rut." } },
            { name: "Queen of Pentacles", svg: `<g><rect x="35" y="40" width="30" height="100" /><path d="M50 20 L40 40 h20z" /><circle cx="50" cy="80" r="15"/></g>`, meanings: {
                upright: { general: "Embodies nurturing practicality and providing security. A down-to-earth, resourceful figure who creates a comfortable home environment.", love: "You or your partner are providing a warm, nurturing, and stable home life. A positive card for a secure and comfortable partnership.", career: "You are practical and resourceful at work, excellent at managing resources. Can signify a successful home-based business.", family: "A nurturing and practical matriarchal figure who makes the house a home. She provides comfort, security, and common sense." },
                reversed: { general: "Warns of a work-life imbalance or financial insecurity. You may be smothering others with your care or neglecting your home and family for work.", love: "You are either smothering your partner with excessive care or neglecting your relationship in favor of work.", career: "Your work-life balance is off. You may be a workaholic who is neglecting your home.", family: "A family matriarch may be smothering or controlling, or neglecting her home duties. A work-life imbalance is causing stress." },
                blunt: "Focus on creating a stable, nurturing, and secure world. If reversed, your life is out of balance; nurture yourself." } },
            { name: "King of Pentacles", svg: `<g><rect x="25" y="40" width="50" height="100" /><path d="M50 20 L35 40 h30z" /><circle cx="50" cy="80" r="20"/><path d="M25 140h50" /></g>`, meanings: {
                upright: { general: "Represents the pinnacle of material success and mastery. A confident, reliable leader who has built a prosperous empire.", love: "You provide incredible stability and security in your relationships. Your approach is dependable and generous.", career: "You have reached the peak of your career through diligence and expertise. You lead with authority, ensuring long-term success.", family: "A successful and prosperous patriarch. He is a provider who has built a secure empire for his family and enjoys sharing his wealth." },
                reversed: { general: "Warns of greed, materialism, and possessiveness. This King can be a reckless gambler or an overly conservative miser.", love: "Your focus on materialism may be creating emotional distance. There is a risk of being possessive or controlling your partner through financial means.", career: "Reckless business decisions, over-the-top spending, or an abuse of power are possible. Your authority may be seen as ruthless.", family: "A patriarch who is greedy or overly controlling with money. His materialism may be damaging his family relationships." },
                blunt: "You have achieved mastery of the material world. Enjoy your empire, but do not let greed risk everything you've built." } }
        ]
    };
    
    // SPREADS & STATE
    const spreads = [ { name: "Personal Growth & Spirituality", context: 'spirituality', positions: ["Where You Are Now", "What You're Ignoring", "How to Heal"], keywords: ["shadow", "trigger", "heal", "trauma", "self-sabotage", "why do i", "my feelings", "purpose", "spiritual path", "inner child", "past life", "ancestors", "myself", "my path", "my journey"] }, { name: "Career & Finance", context: 'career', positions: ["Current Situation", "Strengths", "Weaknesses", "Advice", "Outcome"], keywords: ["career", "job", "promotion", "opportunity", "work", "project", "interview", "raise", "boss", "colleague", "business", "money", "finance", "income", "debt", "investment", "savings", "real estate", "stability", "buy a house"] }, { name: "Interpersonal Dynamics", positions: ["Your Energy", "The Other's Energy", "The Dynamic Between You"], family_keywords: ["family", "friend", "sibling", "mother", "mom", "father", "dad", "parent", "child", "son", "daughter"], love_keywords: ["relationship", "love", "dating", "partner", "crush", "ex", "boyfriend", "girlfriend", "husband", "wife", "commitment", "marriage", "attraction", "soulmate", "he feels", "she feels", "they feel"] }, { name: "Mind, Body, & Spirit Wellness", context: 'health', positions: ["Mind (Mental State)", "Body (Physical State)", "Spirit (Inner State)"], keywords: ["burnout", "burnt out", "stress", "feeling lost", "disconnected", "wellness", "alignment", "health", "wellbeing", "anxiety", "anxious", "depression", "sick", "illness", "tired", "exhausted", "recovery", "healing", "diet", "fitness", "self-care", "mental health"] }, { name: "Situation, Action, Outcome", context: 'general', positions: ["The Situation", "The Recommended Action", "The Likely Outcome"], keywords: ["what should i do", "how should i", "advice", "what's the best way", "what's the outcome", "what to expect", "tell me about", "should I", "navigate", "the situation"] } ];
    const defaultSpread = { name: "General Outlook", context: 'general', positions: ["Your Current Energy", "The Immediate Challenge", "The Path Forward"] };
    const manualSpread = { name: "A Glimpse Into the Flow", context: 'general', positions: ["First Card", "Second Card", "Third Card"] };

    let currentDeck = null, drawnCards = [], selectedManualCards = [], gameState = 'asking', drawMode = 'auto';
    let ui; 
    
    document.addEventListener('DOMContentLoaded', () => {
        ui = {
            deckSelectionScreen: document.getElementById('deck-selection-screen'),
            readingChamberScreen: document.getElementById('reading-chamber-screen'),
            cardDisplay: document.getElementById('card-display'),
            spreadNameEl: document.getElementById('spread-name'),
            interpretationArea: document.getElementById('interpretation-area'),
            chatInterface: document.getElementById('chat-interface'),
            chatForm: document.getElementById('chat-form'),
            userInput: document.getElementById('user-input'),
            submitButton: document.getElementById('submit-button'),
            chatLog: document.getElementById('chat-log'),
            manualSelectionContainer: document.getElementById('manual-selection-container'),
            manualSelectionGrid: document.getElementById('manual-selection-grid'),
            manualSelectionPrompt: document.getElementById('manual-selection-prompt'),
            confirmSelectionBtn: document.getElementById('confirm-selection-btn'),
            leftPanelContent: document.getElementById('left-panel-content')
        };
        
        ui.chatForm.addEventListener('submit', handleFormSubmit);
        ui.confirmSelectionBtn.addEventListener('click', handleConfirmSelection);
    });

    // --- CORE AI LOGIC ---
    async function getAiInterpretation(question, spread, cards, deck) {
        if (!apiKey || apiKey === 'YOUR_OPENAI_API_KEY_HERE') {
            return `<p style="color: #ff9999;"><strong>Configuration Error:</strong> The OpenAI API key is missing. Please edit the script and replace the placeholder with your valid key.</p>`;
        }
        
        const cardDetails = cards.map((card, index) => {
            const position = spread.positions[index] || `Card #${index + 1}`;
            const orientation = card.isReversed ? 'Reversed' : 'Upright';
            const meaning = card.isReversed ? card.meanings.reversed.general : card.meanings.upright.general;
            const blunt = card.meanings.blunt;
            return `\n- Card: ${card.name} (${orientation})\n  - Position: ${position}\n  - Base Meaning: ${meaning}\n  - Blunt Advice Theme: ${blunt}`;
        }).join('');

        const deckPersona = deck.name === 'Demonic Tarot' 
            ? "Your tone is direct, unflinching, pragmatic, and uses sharper language. You focus on stark realities, power dynamics, and self-responsibility." 
            : "Your tone is wise, empowering, slightly mystical, and empathetic. You focus on learning, growth, and gentle guidance.";

        const prompt = `
            You are "The Oracle's Veil," an expert tarot reader. Your interpretations are insightful, comprehensive, and form a single, cohesive narrative.
            
            Reading Context:
            - User's Question: "${question}"
            - Deck Used: ${deck.name}
            - Spread: ${spread.name}

            ${deckPersona}

            Drawn Cards:
            ${cardDetails}

            Your Task:
            1.  Address the user's question directly.
            2.  Weave the meaning of each card, in its specific position, into a flowing narrative. Do NOT just list each card's meaning. Synthesize them.
            3.  Start with a title for the reading related to the user's question.
            4.  Structure your response in well-formed HTML using only <h2> for the title, <h3> for the main sections, <h4> for card positions, <p>, <strong>, and <ul>/<li> for clarity.
            5.  Provide a final "The Oracle's Verdict" or "Final Word" section that summarizes the reading and gives clear, actionable advice.
            6.  Refer to the cards by name within the narrative to connect your points back to the reading.
        `;

        try {
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: "gpt-3.5-turbo",
                    messages: [{ role: "user", content: prompt }],
                    temperature: 0.7,
                })
            });

            if (!response.ok) {
                const errorData = await response.json();
                console.error("OpenAI API Error:", errorData);
                throw new Error(`API Error: ${response.status} - ${errorData.error.message}`);
            }

            const data = await response.json();
            return data.choices[0].message.content;
        } catch (error) {
            console.error("Failed to fetch AI interpretation:", error);
            return `<p style="color: #ff9999;"><strong>Connection Error:</strong> The Oracle's Veil could not reach the ethereal plane. Please check the browser console (F12) for error details. It might be an invalid API key or a network issue.</p><p><em>${error.message}</em></p>`;
        }
    }


    // --- ORIGINAL APP LOGIC (MODIFIED FOR AI) ---

    function buildDeck(deckData) {
        const fullDeck = [];
        ['major', 'wands', 'cups', 'swords', 'pentacles'].forEach(category => {
            if(deckData[category]) {
                deckData[category].forEach(card => fullDeck.push(JSON.parse(JSON.stringify(card))));
            }
        });
        return fullDeck;
    }
    
    window.selectDeck = function(deckName, mode) {
        drawMode = mode;
        currentDeck = { name: deckName === 'goldFoil' ? 'Greco-Roman Tarot' : 'Demonic Tarot', class: deckName, cards: buildDeck(fullDeckData) };
        currentDeck.cards.forEach(card => {
            const strokeColor = deckName === 'goldFoil' ? 'var(--color-primary)' : 'var(--color-secondary)';
            card.svg = (card.svg || '').replace(/<path/g, `<path stroke="${strokeColor}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"`).replace(/<circle/g, `<circle stroke="${strokeColor}" stroke-width="1.5" fill="none"`).replace(/<rect/g, `<rect stroke="${strokeColor}" stroke-width="1.5" fill="none"`).replace(/<ellipse/g, `<ellipse stroke="${strokeColor}" stroke-width="1.5" fill="none"`);
        });

        ui.submitButton.classList.toggle('dark-tarot', deckName === 'darkTarot');
        ui.userInput.addEventListener('focus', () => ui.userInput.style.borderColor = (deckName === 'goldFoil') ? 'var(--color-primary)' : 'var(--color-secondary)');
        ui.userInput.addEventListener('blur', () => ui.userInput.style.borderColor = '#444');

        transitionToScreen(ui.readingChamberScreen, ui.deckSelectionScreen);
        addMessageToLog('oracle', `You chose the ${currentDeck.name} & '${mode === 'auto' ? 'Oracle\'s Choice' : 'Guided Draw'}'. What do you wish to know?`);
    }

    function handleFormSubmit(event) {
        event.preventDefault();
        const question = ui.userInput.value.trim();
        if (question === '' || ui.submitButton.disabled) return;
        
        addMessageToLog('user', question);
        ui.userInput.value = '';
        if (question.toLowerCase().includes('reset') || question.toLowerCase().includes('shuffle')) {
            resetForNewReading();
            return;
        }

        if (gameState === 'asking') performReading(question);
        else addMessageToLog('oracle', "This session is complete. To ask a new question, please type 'reset' to begin a new reading.");
    }
    
    function performReading(question) {
        ui.submitButton.disabled = true;
        ui.userInput.placeholder = "The oracle is concentrating...";
        gameState = 'reading';
        ui.leftPanelContent.style.opacity = '0';

        setTimeout(() => {
            if (drawMode === 'auto') {
                const { spread, context, subjects } = analyzeQuestion(question);
                const numCardsToDraw = spread.positions.length;
                drawnCards = drawCardsFromPool(currentDeck.cards, numCardsToDraw);
                
                ui.spreadNameEl.textContent = spread.name;
                ui.spreadNameEl.classList.add('visible');
                
                // Call the new async function
                displayAndInterpretCards(drawnCards, spread, subjects, context, question);

            } else { // Manual mode
                ui.spreadNameEl.textContent = manualSpread.name;
                ui.spreadNameEl.classList.add('visible');
                ui.cardDisplay.style.display = "none";
                ui.manualSelectionContainer.style.display = 'block';
                displayFullManualSpread();
            }
            ui.leftPanelContent.style.opacity = '1';
        }, 500);
    }
    
    function analyzeQuestion(question) {
        const q = question.toLowerCase();
        let subjects = ['You', 'The Other'];
        
        const interpersonal = spreads.find(s => s.name === "Interpersonal Dynamics");
        for (const kw of interpersonal.family_keywords) { if (q.includes(kw)) return { spread: interpersonal, context: 'family', subjects }; }
        for (const kw of interpersonal.love_keywords) { if (q.includes(kw)) return { spread: interpersonal, context: 'love', subjects }; }
        
        for (const s of spreads) { if (s.keywords) for (const kw of s.keywords) if (q.includes(kw)) return { spread: s, context: s.context, subjects: [] }; }
        
        return { spread: defaultSpread, context: defaultSpread.context, subjects: [] };
    }

    function drawCardsFromPool(pool, num) {
        const shuffledPool = [...pool].sort(() => 0.5 - Math.random());
        return shuffledPool.slice(0, num).map(card => ({...card, isReversed: Math.random() < 0.5}));
    }

    async function displayAndInterpretCards(cards, spread, subjects, context, question) {
        // Apply deck theme to interpretation area for AI styling
        ui.interpretationArea.className = currentDeck.class;
        
        // Clear old results
        ui.cardDisplay.style.display = "flex";
        ui.cardDisplay.innerHTML = '';
        ui.interpretationArea.innerHTML = '<p>The Oracle is weaving the threads of fate... please wait.</p>';

        // Display the cards visually
        cards.forEach((card, index) => {
            const positionName = subjects.length 
                ? spread.positions[index].replace('Your', subjects[0]).replace("The Other's", subjects[1] + "'s") 
                : spread.positions[index];
            
            const container = createCardContainer(card, positionName);
            ui.cardDisplay.appendChild(container);
            
            // Stagger the flip animation
            setTimeout(() => container.classList.add('flipped'), (index + 1) * 400);
        });
        
        // Fetch AI interpretation and display it
        const aiInterpretation = await getAiInterpretation(question, spread, cards, currentDeck);
        ui.interpretationArea.innerHTML = aiInterpretation;

        // Re-enable form after interpretation is complete
        setTimeout(() => {
            ui.submitButton.disabled = false;
            ui.userInput.placeholder = "Reading complete. Type 'reset' to start over.";
        }, cards.length * 400 + 200);
    }
    
    function displayFullManualSpread() {
        ui.confirmSelectionBtn.className = 'dark-tarot';
        ui.confirmSelectionBtn.classList.toggle('dark-tarot', currentDeck.class === 'darkTarot');

        ui.manualSelectionGrid.innerHTML = '';
        selectedManualCards = [];
        const shuffledDeck = [...currentDeck.cards].sort(() => 0.5 - Math.random());

        shuffledDeck.forEach((card) => {
            const miniCard = document.createElement('div');
            miniCard.className = 'mini-card';
            miniCard.classList.add(currentDeck.class);
            miniCard.textContent = "✶";
            miniCard.dataset.cardData = JSON.stringify({...card, isReversed: Math.random() < 0.5});
            miniCard.addEventListener('click', handleMiniCardClick);
            ui.manualSelectionGrid.appendChild(miniCard);
        });
        updateManualSelectionPrompt();
    }
    
    function handleMiniCardClick(event) {
        const miniCard = event.currentTarget;
        if (selectedManualCards.length >= 3 && !miniCard.classList.contains('selected')) return;

        miniCard.classList.toggle('selected');
        miniCard.classList.toggle('dark-tarot', currentDeck.class === 'darkTarot' && miniCard.classList.contains('selected'));
        
        selectedManualCards = Array.from(ui.manualSelectionGrid.querySelectorAll('.selected'));
        updateManualSelectionPrompt();
    }

    function updateManualSelectionPrompt() {
        const remaining = 3 - selectedManualCards.length;
        ui.manualSelectionPrompt.textContent = remaining > 0 ? `Focus on your question. Select ${remaining} more card${remaining > 1 ? 's' : ''}.` : 'You have chosen your cards. Confirm your selection.';
        ui.confirmSelectionBtn.disabled = remaining > 0;
    }

    function handleConfirmSelection() {
        ui.manualSelectionContainer.style.display = 'none';
        
        // Find the original question from the chat log
        const userMessages = ui.chatLog.getElementsByClassName('user-message');
        const lastQuestion = userMessages.length > 0 ? userMessages[userMessages.length - 1].innerText : "The cards I have chosen.";
        
        const chosenCards = selectedManualCards.map(el => JSON.parse(el.dataset.cardData));
        
        // Use the main interpretation function, unifying the experience
        displayAndInterpretCards(chosenCards, manualSpread, [], 'general', lastQuestion);
    }
    
    function createCardContainer(card, position) {
        const container = document.createElement('div');
        container.className = `tarot-card-container ${card.isReversed ? 'reversed' : ''}`;
        container.innerHTML = `<div class="tarot-card">
            <div class="card-face card-face-back ${currentDeck.class}"></div>
            <div class="card-face card-face-front ${currentDeck.class}">
                <div class="card-name">${card.name} ${card.isReversed ? '(R)' : ''}</div>
                <div class="card-visual"><svg viewBox="0 0 100 160" preserveAspectRatio="xMidYMid meet">${card.svg || ''}</svg></div>
                <div class="card-position">${position}</div>
            </div>
        </div>`;
        return container;
    }
    
    function resetForNewReading() {
        transitionToScreen(ui.deckSelectionScreen, ui.readingChamberScreen);
        gameState = 'asking';
        drawnCards = [];
        selectedManualCards = [];
        ui.cardDisplay.innerHTML = '';
        ui.interpretationArea.innerHTML = '';
        ui.interpretationArea.className = '';
        ui.spreadNameEl.textContent = '';
        ui.spreadNameEl.classList.remove('visible');
        ui.chatLog.innerHTML = '';
        ui.leftPanelContent.style.opacity = '1';
        ui.manualSelectionContainer.style.display = 'none';
        ui.cardDisplay.style.display = 'flex';
        ui.userInput.placeholder = "Ask your question...";
        ui.submitButton.disabled = false;
    }

    function transitionToScreen(newScreen, oldScreen) {
        if(oldScreen) oldScreen.style.display = 'none';
        if (newScreen === ui.readingChamberScreen) ui.chatInterface.style.display = 'block';
        newScreen.style.display = 'block';
    }
    
    function addMessageToLog(sender, text) {
        const messageEl = document.createElement('div');
        messageEl.classList.add('chat-message', `${sender}-message`);
        messageEl.innerHTML = text; // Use innerHTML to allow basic formatting in messages if needed
        ui.chatLog.appendChild(messageEl);
        ui.chatLog.scrollTop = ui.chatLog.scrollHeight;
    }
</script>
</body>
</html>
```